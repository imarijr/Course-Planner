(function(angular){
'use strict';
angular
    .module('root', [
        'common',
        'components',
        'templates',
        'ngMaterial'
    ]);})(window.angular);
(function(angular){
'use strict';
angular
  .module('common', [
    'ui.router',
    'ngMaterial',
    'ngParse',
  ])
  .run(function () {
    console.log("common module")
  });})(window.angular);
(function(angular){
'use strict';
angular 
    .module('components', 
    ['components.home',
    'components.semesters',
    'ngMaterial'
]); })(window.angular);
(function(angular){
'use strict';
angular
    .module('components.home', [
        'ui.router',
        'ngMaterial'
        
    ]);})(window.angular);
(function(angular){
'use strict';
angular
    .module('components.semesters', [
        'ui.router',
        'ngMaterial',
        'ui.sortable'
        
    ]);})(window.angular);
(function(angular){
'use strict';
var root = {
    templateUrl: './root.html'
  };
  
  angular
    .module('root')
    .component('root', root);



})(window.angular);
(function(angular){
'use strict';
var appNav = {
    templateUrl: './app-nav.html'
  };
  
  angular
    .module('common')
    .component('appNav', appNav);})(window.angular);
(function(angular){
'use strict';
var app = {
    templateUrl: './app.html',
    controller: 'AppController'
  };
  
  angular
    .module('common')
    .component('app', app)
    .config(["$stateProvider", function ($stateProvider) {
      $stateProvider
        .state('app', {
              redirectTo:  "home",
              url: '/',
              component: 'app',

            }
          
        )
    }]);})(window.angular);
(function(angular){
'use strict';
config.$inject = ["ParseProvider", "$locationProvider"];
function config(ParseProvider, $locationProvider) {
  ParseProvider.serverURL = 'https://parseapi.back4app.com'; // This is your Server URL
  ParseProvider.initialize(
    'UZwpFbGYPWGGKsVAt5vRzPbH1lSdX6u77OF3KrD5', // This is your Application ID
    'IpK6jyzdSSOGfqfM5SbA90UmakjLChfbEjcaPFBS' // This is your Javascript key
  );
  $locationProvider.hashPrefix('');
}

angular.module('common').config(config);})(window.angular);
(function(angular){
'use strict';
  AppController.$inject = ["$state"];
function AppController($state) {
    var ctrl = this;
    console.log("app controller")
  }
  
  angular
    .module('common')
    .controller('AppController', AppController);})(window.angular);
(function(angular){
'use strict';
init.$inject = ["$uiRouter"];
function init( $uiRouter){
    var Visualizer = window['ui-router-visualizer'].Visualizer;
    var plugInstance = $uiRouter.plugin(Visualizer);
}

angular.module('common').run(init)})(window.angular);
(function(angular){
'use strict';
/**
 * @ngdoc service
 * @name common.service:CourseModel
 *
 * @description Model and helper methods for CourseModel parse object.
 */

class CourseModel {
    constructor(Parse, MajorModel) {
        this.Parse = Parse;
        this.MajorModel = MajorModel
        this.data = {};
        this.collection = [];
        this.name = 'Course';
        this.fields = [
            'courseName',
            'corequisites',
            'semesterDefault', 
            'courseId',
            'semesterRequired',
            'attributes',
            'defaultMajor',
            'credits',
            'prerequisites'
        ];
    }
    New(obj) {
        if (angular.isUndefined(obj)) {
            const parseObject = new this.Parse.Object(this.name);
            this.Parse.defineAttributes(parseObject, this.fields);
            // parseObject.major = new this.Parse.Object(this.MajorModel.name)
            // this.Parse.defineAttributes(parseObject.major); 
            return parseObject;
        } else {
            this.Parse.defineAttributes(obj, this.fields);
            // this.Parse.defineAttributes(obj.major, this.MajorModel.fields); 
            return obj;
        }
    }
    getById(id) {
        console.log(id)
        return new this.Parse.Query(this.New())
            .equalTo("objectId", id)
            .find()
            .then(result => {
                console.log('result', result)
                this.Parse.defineAttributes(result, this.fields);
                this.data = result;
                return Promise.resolve(result);
            })
            .catch(error => Promise.reject(error));
    }

    getByName(name) {
        console.log("name passed in: ", name)
        return new this.Parse.Query(this.New())
            .equalTo("courseName", name)
            .find()
            .then(result => {
                console.log('result: ', result[0]);         // no two courses should have the same name
                                                                    // so should only be one result
                //this.Parse.defineAttributes(result[0], this.fields); 
                //this.data = result[0]; 
                return Promise.resolve(result[0]); 
            })
            .catch(error => Promise.reject(error))
    }

    getByMajor(major) {
        return new this.Parse.Query(this.New())
            .include('major')
            .equalTo('major', major)
            .find()
            .then(courses => {
                courses.forEach(course => {
                    this.Parse.defineAttributes(course, this.fields);
                    this.Parse.defineAttributes(course.major, this.CourseModel.fields);
                })
                this.collection = courses;
                console.log("getByMajor", this.collection)
                return Promise.resolve(courses);
            })
            .catch(error => Promise.reject(error));
    }

    setSemesterDefault(id, sem) {
        //myobj = new this.Parse.Query(this.New())
        return new this.Parse.Query(this.New())
            .get(id)
            .then(result => {
                // this.Parse.defineAttributes(result, this.fields);
                // this.data = result; 
                result.set("semesterDefault", sem); 
                console.log('new default should be 3: ', result); 
                result.save(); 
                return Promise.resolve(result); 
            }).catch(error => Promise.reject(error))
    }

    removeSemesterDefault(id) {
        //myobj = new this.Parse.Query(this.New())
        return new this.Parse.Query(this.New())
            .get(id)
            .then(result => {
                // this.Parse.defineAttributes(result, this.fields);
                // this.data = result; 
                result.set("semesterDefault", null); 
                console.log('new default should be 3: ', result); 
                result.save(); 
                return Promise.resolve(result); 
            }).catch(error => Promise.reject(error))
    }

    getCourseBySem(semDef) {
        return new this.Parse.Query(this.New())
            .equalTo("semesterDefault", semDef)
            .find().then(result => {
                this.data = result;
                console.log("result of getCourseBySem: ", result);
                return Promise.resolve(result);
            })
            .catch(error => Promise.reject(error));
    }

    getCourses() {
        return new this.Parse.Query(this.New())
            .find().then(result => {
                return Promise.resolve(result); 
            })
            .catch(error => Promise.reject(error)); 
    }
}

angular
    .module('common')
    .service('CourseModel', CourseModel);
})(window.angular);
(function(angular){
'use strict';
class JSONService {
    constructor($http){
        this.$http = $http
    }

    getSemesterData() {
        return this.$http({
            method: 'GET',
            url: '../data.json',
        })
    }
    getClassData() {
        return this.$http({
            method: 'GET',
            url: '../addClass.json',
        })
    }

}

angular
    .module('common')
    .service('JSONService', JSONService);})(window.angular);
(function(angular){
'use strict';
/**
 * @ngdoc service
 * @name common.service:MajorModel
 *
 * @description Model and helper methods for MajorModel parse object.
 */

class MajorModel {
    constructor(Parse) {
        this.Parse = Parse;
        this.data = {};
        this.collection = [];
        this.name = 'Major';
        this.fields = [
            'credits',
            'majorName',
            'college'
        ];
    }
    New(obj) {
        if (angular.isUndefined(obj)) {
            const parseObject = new this.Parse.Object(this.name)
            this.Parse.defineAttributes(parseObject, this.fields);
            return parseObject;
        } else {
            this.Parse.defineAttributes(obj, this.fields);
            return obj;
        }
    }
    getById(id) {
        return new this.Parse.Query(this.New())
            .get(id)
            .then(result => {
                console.log('result', result)
                this.Parse.defineAttributes(result, this.fields);
                this.data = result;
                return Promise.resolve(result);
            })
            .catch(error => Promise.reject(error));
    }
    getByName(name) {
        return new this.Parse.Query(this.New())
            .equalTo("majorName", name)
            .find().then(result => {
                console.log('result', result)
                this.Parse.defineAttributes(result, this.fields); 
                this.data = result; 
                return Promise.resolve(result); 
            })
            .catch(error => Promise.reject(error))
    }
    getMajors() {
        return new this.Parse.Query(this.New())
        .find().then(result => {
            this.data = result
            return Promise.resolve(result);
        })
        .catch(error => Promise.reject(error));
    }
}

angular
    .module('common')
    .service('MajorModel', MajorModel);
})(window.angular);
(function(angular){
'use strict';
var home = {
    templateUrl: './home.html',
    controller: 'HomeController',

}

angular
    .module('components.home')
    .component('home', home)
    .config(["$stateProvider", "$urlRouterProvider", function ($stateProvider, $urlRouterProvider) {
        $stateProvider.state('home', {
            parent: 'app',
            url: 'home',
            component: 'home'
        })
    $urlRouterProvider.otherwise('/');
    }]); 

    })(window.angular);
(function(angular){
'use strict';

/**
 * @ngdocs directive
 * 
 * @function HomeController
 * 
 * @param {*} $state 
 * @param {*} MajorModel 
 * 
 * @description
 * Home controller for the first page which displays the major options in the dropdown list.
 */

  HomeController.$inject = ["$state", "MajorModel"];
function HomeController($state, MajorModel) {
    var ctrl = this;
      this.$onInit = function () {
      console.log("home controller")
      let majors_list = []
      MajorModel.getMajors().then(function(majors) {
        for (var i = 0; i < majors.length; i++) {
          majors_list.push(majors[i].attributes.majorName)
        }
        ctrl.majors = majors_list;
      })
    }
  }


angular
    .module('components.home')
    .controller('HomeController', HomeController);})(window.angular);
(function(angular){
'use strict';
var semesters = {
    templateUrl: './semesters.html',
    controller: 'SemestersController',

}

angular
    .module('components.semesters')
    .component('semesters', semesters)
    .config(["$stateProvider", function ($stateProvider) {
        $stateProvider.state('semesters', {
            parent: 'app',
            url: 'semesters',
            component: 'semesters'
        })
    }])

    })(window.angular);
(function(angular){
'use strict';
/**
 * @ngdoc directive 
 * 
 * @function SemestersController
 * 
 * @param {*} $http 
 * @param {*} $mdDialog 
 * @param {*} JSONService 
 * @param {*} CourseModel 
 * @param {*} $window 
 * 
 * @description
 * The semesters controller is used for the semesters page. 
 */

SemestersController.$inject = ["$http", "$mdDialog", "JSONService", "CourseModel", "$window"];
function SemestersController($http, $mdDialog, JSONService, CourseModel, $window) {
    var ctrl = this;
    console.log("semesters controller")

    /**
     * @ngdoc directive
     * @function populateLists 
     * @param {*} CourseModel
     * 
     * @description
     * This function is used to generate all 8 semesters on the semesters page. For each semester, if a class' 
     * default semester is set to that specific semester the class gets added to that semester.
     */

    function populateLists(CourseModel) {
        ctrl.models = {
            selected: null,
            semesters: {
                1: [],
                2: [],
                3: [],
                4: [],
                5: [],
                6: [],
                7: [],
                8: []
            },
            prereqs: {}, // will be key value pair of class name and prereqs list 
            names: {},
            credits: {},
            creditTotal: [0, 0, 0, 0, 0, 0, 0, 0],
            conflictingClasses: []
        };
        // sem 1 
        console.log("populating lists")
        var courses =  CourseModel.getCourseBySem(1).then(function(courses) {
            for (var idx=0; idx<courses.length; idx++) {
                var className = courses[idx].attributes.courseName;   // ie "Calculus II" 
                ctrl.models.semesters[1].push(className);
                ctrl.models.prereqs[className] = courses[idx].attributes.prerequisites;     // ie ["MATH 10550"]
                ctrl.models.names[className] = courses[idx].attributes.courseId;            // ie "MATH 10560"
                ctrl.models.credits[className] = courses[idx].attributes.credits;           // ie 3
                ctrl.models.creditTotal[0] += courses[idx].attributes.credits;
            }
        })

        // sem 2 
        courses =  CourseModel.getCourseBySem(2).then(function(courses) {
            for (var idx=0; idx<courses.length; idx++) {
                var className = courses[idx].attributes.courseName;   // ie "Calculus II" 
                ctrl.models.semesters[2].push(className);
                ctrl.models.prereqs[className] = courses[idx].attributes.prerequisites;     // ie ["MATH 10550"]
                ctrl.models.names[className] = courses[idx].attributes.courseId;            // ie "MATH 10560"
                ctrl.models.credits[className] = courses[idx].attributes.credits;           // ie 3
                ctrl.models.creditTotal[1] += courses[idx].attributes.credits;
            }
        })

        // sem 3 
        courses =  CourseModel.getCourseBySem(3).then(function(courses) {
            for (var idx=0; idx<courses.length; idx++) {
                var className = courses[idx].attributes.courseName;   // ie "Calculus II" 
                ctrl.models.semesters[3].push(className);
                ctrl.models.prereqs[className] = courses[idx].attributes.prerequisites;     // ie ["MATH 10550"]
                ctrl.models.names[className] = courses[idx].attributes.courseId;            // ie "MATH 10560"
                ctrl.models.credits[className] = courses[idx].attributes.credits;           // ie 3
                ctrl.models.creditTotal[2] += courses[idx].attributes.credits;
            }
        })

        // sem 4
        courses =  CourseModel.getCourseBySem(4).then(function(courses) {
            for (var idx=0; idx<courses.length; idx++) {
                var className = courses[idx].attributes.courseName;   // ie "Calculus II" 
                ctrl.models.semesters[4].push(className);
                ctrl.models.prereqs[className] = courses[idx].attributes.prerequisites;     // ie ["MATH 10550"]
                ctrl.models.names[className] = courses[idx].attributes.courseId;            // ie "MATH 10560"
                ctrl.models.credits[className] = courses[idx].attributes.credits;           // ie 3
                ctrl.models.creditTotal[3] += courses[idx].attributes.credits;
            }
        })

        // sem 5
        courses =  CourseModel.getCourseBySem(5).then(function(courses) {
            for (var idx=0; idx<courses.length; idx++) {
                var className = courses[idx].attributes.courseName;   // ie "Calculus II" 
                ctrl.models.semesters[5].push(className);
                ctrl.models.prereqs[className] = courses[idx].attributes.prerequisites;     // ie ["MATH 10550"]
                ctrl.models.names[className] = courses[idx].attributes.courseId;            // ie "MATH 10560"
                ctrl.models.credits[className] = courses[idx].attributes.credits;           // ie 3
                ctrl.models.creditTotal[4] += courses[idx].attributes.credits;
            }
        })

        // sem 6
        courses =  CourseModel.getCourseBySem(6).then(function(courses) {
            for (var idx=0; idx<courses.length; idx++) {
                var className = courses[idx].attributes.courseName;   // ie "Calculus II" 
                ctrl.models.semesters[6].push(className);
                ctrl.models.prereqs[className] = courses[idx].attributes.prerequisites;     // ie ["MATH 10550"]
                ctrl.models.names[className] = courses[idx].attributes.courseId;            // ie "MATH 10560"
                ctrl.models.credits[className] = courses[idx].attributes.credits;           // ie 3
                ctrl.models.creditTotal[5] += courses[idx].attributes.credits;
            }
        })

        // sem 7
        courses =  CourseModel.getCourseBySem(7).then(function(courses) {
            for (var idx=0; idx<courses.length; idx++) {
                var className = courses[idx].attributes.courseName;   // ie "Calculus II" 
                ctrl.models.semesters[7].push(className);
                ctrl.models.prereqs[className] = courses[idx].attributes.prerequisites;     // ie ["MATH 10550"]
                ctrl.models.names[className] = courses[idx].attributes.courseId;            // ie "MATH 10560"
                ctrl.models.credits[className] = courses[idx].attributes.credits;           // ie 3
                ctrl.models.creditTotal[6] += courses[idx].attributes.credits;
            }
        })

        // sem 8
        courses =  CourseModel.getCourseBySem(8).then(function(courses) {
            for (var idx=0; idx<courses.length; idx++) {
                var className = courses[idx].attributes.courseName;   // ie "Calculus II" 
                ctrl.models.semesters[8].push(className);
                ctrl.models.prereqs[className] = courses[idx].attributes.prerequisites;     // ie ["MATH 10550"]
                ctrl.models.names[className] = courses[idx].attributes.courseId;            // ie "MATH 10560"
                ctrl.models.credits[className] = courses[idx].attributes.credits;           // ie 3
                ctrl.models.creditTotal[7] += courses[idx].attributes.credits;
            }
        })

    }

    /**
     * @ngdoc directive
     * 
     * @function calculateCreditTotalsPrereqs
     * 
     * @description
     * This function is used to check if there are too many classes in a semester (goes over credit maximum) and all prereqs are satisfied.
     */

    function calculateCreditTotalsPrereqs() {
        angular.forEach(ctrl.models.semesters, function (value, key) {
            for (let i=0; i<value.length; i++) {
                ctrl.models.creditTotal[key-1] += ctrl.models.credits[ctrl.models.semesters[key][i]]
            }
        })


        // Connects semester lists for drap and drop
        ctrl.classWarning = false

        ctrl.courseMap = {
            stop: function (e, ui) {
                //reset creditTotals
                console.log("calculating credits")
                ctrl.models.creditTotal = [0, 0, 0, 0, 0, 0, 0, 0]
                ctrl.classWarning = false
                //console.log("Updated Course Map", JSON.stringify(ctrl.models.semesters, undefined, 2))
                var currentClasses = []
                // loop through semesters
                for (let i = 1; i < 9; i++) {
                    length = ctrl.models.semesters[i].length

                    // loop through classes
                    for (let j = 0; j < length; j++) {
                        // calculate new credit totals
                        ctrl.models.creditTotal[i - 1] += ctrl.models.credits[ctrl.models.semesters[i][j]]

                        // make sure that moves get saved to parse - save each class+semester
                        CourseModel.getByName(ctrl.models.semesters[i][j]).then(function(course) {
                            console.log("course back from get by name: ", course)
                            CourseModel.setSemesterDefault(course.id, i).then(function(success) {
                            console.log("success!")
                            });
                        })
                        var prereqs = ctrl.models.prereqs[ctrl.models.semesters[i][j]]
                        if (prereqs != null) {
                            var plength = prereqs.length
                            // loop through prerequisites 
                            for (let m = 0; m < plength; m++) {
                                if (currentClasses.includes(prereqs[m]) == false) {
                                    console.log("breaking a prerequisities rule: ") // if prereq not in "taken" classes
                                    console.log(prereqs[m])
                                    ctrl.classWarning = true
                                    console.log(ctrl.classWarning)
                                }
                            }
                        }
                    }

                    // append on all classes you've taken so far, including this semester
                    for (let k = 0; k < length; k++) {
                        var classnum = ctrl.models.names[ctrl.models.semesters[i][k]]
                        currentClasses.push(classnum)

                    }
                }
                console.log("Credits: ", ctrl.models.creditTotal)
            },
            placeholder: "course",
            connectWith: ".course-list"
        }
    }

    populateLists(CourseModel); 
    calculateCreditTotalsPrereqs(); 
    
    ctrl.addClass = function(event, semester) {
        console.log('semester: ', semester)
        var config = {
            parent: angular.element(document.body),
            controller: AddClassController,
            controllerAs: '$ctrl',
            disableParentScroll: true, 
            templateUrl: './addclass.html',
            hasBackdrop: true, 
            trapFocus: true, 
            clickOutsideToClose: true, 
            escapeToClose: true, 
            focusOnOpen: true,
            fullscreen: true, 
            targetEvent: event
        }

        $mdDialog.show(config)
            .then(answer => {
                console.log('answer: ', answer); 
            })


    /**
     * @ngdoc directive
     * 
     * @function AddClassController
     * 
     * @param {*} $state 
     * @param {*} $mdDialog 
     * @param {*} $http 
     * @param {*} JSONService 
     * @param {*} CourseModel 
     * @param {*} $window 
     * 
     * @description
     * This function acts as the add class controller (which is no loner its own page, but a popup). When the add class button is clicked,
     * all the classes that do not have a default semester populate the dialogue window. When a class gets added, once the data is returned from 
     * the db, the popup closes and the page refreshes to reflect the updated semester view.
     */

    function AddClassController($state, $mdDialog, $http, JSONService, CourseModel, $window) {
        var ctrl = this;
        console.log("running controller")
        ctrl.allClasses = []
        CourseModel.getCourses().then(function(courses) {
        console.log('courses: ', courses); 
        for (var i = 0; i < courses.length; i++) {
            if (courses[i].attributes.semesterDefault == null) {
            ctrl.allClasses.push(courses[i])
            console.log(courses[i].attributes.courseName)
            }
        }
        console.log('courses listed...', ctrl.allClasses)
        }).catch(function() {
        console.log("couldn't fetch courses")
        })

        console.log('courses listed...', ctrl.allClasses)

        // go through each of the classes to get the description of the class
        ctrl.doSecondaryAction = function(event, description) {
            $mdDialog.show(
                $mdDialog.alert()
                .title("Course Description")
                .textContent(description)
                .ok('Ok')
                .targetEvent(event)
            );
        };

        ctrl.addCourseToSemester = function(event, course) {
            CourseModel.getByName(course).then(function(course) {
                console.log('sending id to setSemesterDefault')
                CourseModel.setSemesterDefault(course.id, parseInt(semester)).then(function(success) {
                    console.log('set new default')
                }).catch(function () {
                    populateLists(CourseModel);
                    console.log('failed to set new default.'); 
                })
                
                $mdDialog.cancel().then(function() {
                    console.log("successfully closed.")
                    $state.reload();
                }).catch(function () {
                    console.log("failed to close.");
                })

            }).catch(function() {
                console.log()
                console.log('failed to get class')
            })
        }
    }
}

     // delete class "controller"
     ctrl.deleteClass = function(event, semester) {
        console.log('semester: ', semester)
        var config = {
            parent: angular.element(document.body),
            controller: DeleteClassController,
            controllerAs: '$ctrl',
            disableParentScroll: true, 
            templateUrl: './deleteclass.html',
            hasBackdrop: true, 
            trapFocus: true, 
            clickOutsideToClose: true, 
            escapeToClose: true, 
            focusOnOpen: true,
            fullscreen: true, 
            targetEvent: event
        }

        $mdDialog.show(config)
            .then(answer => {
                console.log('answer: ', answer); 
            })


        /**
         * @ngdoc directive
         * 
         * @function DeleteClassController
         * 
         * @param {*} $state 
         * @param {*} $mdDialog 
         * @param {*} $http 
         * @param {*} JSONService 
         * @param {*} CourseModel 
         * @param {*} $window 
         * 
         * @description
         * This function acts as the delete class controller, which now generates each class in a semester on a popup. If the delete button is 
         * clicked, the semester default value is set to null in the database. Once the process from the db is returned the popup closes and 
         * the page refreshes with the updated semester list.
         */
        
        function DeleteClassController($state, $mdDialog, $http, JSONService, CourseModel, $window) {
            var ctrl = this;
            ctrl.allClasses = []
            console.log("semester...? ", semester)
            CourseModel.getCourseBySem(parseInt(semester)).then(function(courses) {
            console.log('courses: ', courses); 
            for (var i = 0; i < courses.length; i++) {
                ctrl.allClasses.push(courses[i])
                console.log(courses[i].attributes.courseName)
            }
            console.log('courses listed...', ctrl.allClasses)
            }).catch(function() {
            console.log("couldn't fetch courses")
            })
    
            console.log('courses listed...', ctrl.allClasses)
        
            // go through each of the classes to get the description of the class
            ctrl.doSecondaryAction = function(event, description) {
                $mdDialog.show(
                    $mdDialog.alert()
                    .title("Course Description")
                    .textContent(description)
                    .ok('Ok')
                    .targetEvent(event)
                );
            };
        
            ctrl.removeCourseFromSemester = function(event, course) {
                CourseModel.getByName(course).then(function(course) {
                    console.log('sending id to setSemesterDefault')
                    CourseModel.removeSemesterDefault(course.id).then(function(success) {
                        console.log('set new default')
                    }).catch(function () {
                        populateLists(CourseModel);
                        console.log('failed to set new default.'); 
                    })
        
                    $mdDialog.cancel().then(function() {
                        console.log("closed popup");
                        $state.reload();
                    }).catch(function () {
                        console.log("failed to close");
                    })
        
                }).catch(function() {
                    console.log()
                    console.log('failed to get class')
                })
            }
        }    
    }
}

angular
    .module('components.semesters')
    .controller('SemestersController', SemestersController);})(window.angular);
(function(angular){
'use strict';
angular.module('templates', []).run(['$templateCache', function($templateCache) {$templateCache.put('./root.html','<div class="root">\r\n    <div ui-view></div>\r\n</div>');
$templateCache.put('./app-nav.html','<header>\r\n  <md-toolbar>\r\n      <div class="md-toolbar-tools" layout="row" layout-align="space-between center">\r\n          <div>\r\n              <a href="#"><i class="material-icons">home</i></a>\r\n          </div>\r\n          <div>\r\n              <h3>Course Planner</h3>\r\n          </div>\r\n      </div>\r\n  </md-toolbar>\r\n</header>');
$templateCache.put('./app.html','<div class="root">\r\n  <div>\r\n    <div ui-view></div>\r\n  </div>\r\n</div>');
$templateCache.put('./home.html','<app-nav></app-nav>\r\n<md-input-container class="md-block" flex-gt-sm>\r\n    <h2>Choose your major to get started.</h2>\r\n    <label>My Major</label>\r\n    <md-select ng-model="majorChosen" ng-change="onChange()">\r\n      <!-- stateful component -->\r\n      <md-option ng-repeat="major in $ctrl.majors" value="{{major}}">\r\n        {{major}}\r\n      </md-option>\r\n    </md-select>\r\n  </md-input-container>\r\n\r\n  <md-button md-no-ink class="md-go-button" ng-click = "saveMajor()" href="#/semesters">Go</md-button>');
$templateCache.put('./addclass.html','<!-- stateful component -->\r\n  <md-input-container class="md-block-addclass" flex-gt-sm>\r\n      <h1 class="additional-options">Additional Class Options</h1> \r\n    <!-- stateless component -->\r\n    <md-list-item ng-repeat="course in $ctrl.allClasses" value="{{course.attributes.courseName}}" class="secondary-button-padding-class addClass-items">\r\n      <p>{{course.attributes.courseName}}</p>\r\n      <md-button class="md-secondary" ng-click="$ctrl.addCourseToSemester($event, course.attributes.courseName)" href="#/semesters">add class</md-button>\r\n    </md-list-item>\r\n  </md-input-container>\r\n');
$templateCache.put('./deleteclass.html','<!-- stateful component -->\r\n<md-input-container class="md-block-addclass" flex-gt-sm>\r\n    <h1 class="additional-options">Remove Class</h1> \r\n  <!-- stateless component -->\r\n  <md-list-item ng-repeat="course in $ctrl.allClasses" value="{{course.attributes.courseName}}" class="secondary-button-padding-class">\r\n    <p>{{course.attributes.courseName}}</p>\r\n    <md-button class="md-secondary" ng-click="$ctrl.removeCourseFromSemester($event, course.attributes.courseName)" href="#/semesters">remove class</md-button>\r\n  </md-list-item>\r\n</md-input-container>\r\n');
$templateCache.put('./semesters.html','<app-nav></app-nav>\r\n<div class="course-map">\r\n    <md-content layout-padding>\r\n        <div ng-show="$ctrl.classWarning" class="warning-text">\r\n            One or more classes need adjusting to satisfy prerequisite requirements. \r\n        </div>\r\n        <!-- Grid List to Keep even layout -->\r\n        <md-grid-list  md-cols-sm="1" md-cols-md="1" md-cols-lg="2" md-cols-gt-lg="3" md-cols=1 md-row-height-md="1:1" md-row-height="1.2:1"\r\n            md-gutter-gt-md="16px" md-gutter-md="8px" md-gutter="4px">\r\n            <!-- Each Tile holds a list of semester courses -->\r\n            <!-- stateful component -->\r\n            <md-grid-tile ng-repeat="(key, semester) in $ctrl.models.semesters">\r\n                <!-- ui-sortable allows drag drop sorting of \r\n                    arrays courseMap is the drag drop group -->\r\n                    <!-- stateless component -->\r\n                <md-list ui-sortable="$ctrl.courseMap" class="course-list" ng-model="semester">\r\n                    <md-subheader class="md-no-sticky">Semester {{$index+1}}</md-subheader>\r\n                    <!-- repeats each class in a semester -->\r\n                    <md-list-item ng-repeat="item in semester" class="md-2-line course">\r\n                        <div class="md-list-item-text">\r\n                            {{item}}\r\n                        </div>\r\n                        <md-divider></md-divider>\r\n                    </md-list-item>\r\n                    <!-- display the running total of credits for each semester-->\r\n                    <div style="margin: 30px"></div>\r\n                    <p>Credits: {{$ctrl.models.creditTotal[$index]}}\r\n                    <md-button style="float: right; margin-top: -10px" ng-click = "$ctrl.deleteClass($event, key)">Delete Class</md-button>\r\n                    <md-button style="float: right; margin-top: -10px" ng-click = "$ctrl.addClass($event, key)">Add Class</md-button></p>\r\n                </md-list>\r\n            </md-grid-tile>\r\n        </md-grid-list>\r\n    </md-content>\r\n</div>');}]);})(window.angular);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJvb3QubW9kdWxlLmpzIiwiY29tbW9uL2FwcC5tb2R1bGUuanMiLCJjb21wb25lbnRzL2NvbXBvbmVudHMubW9kdWxlLmpzIiwiY29tcG9uZW50cy9ob21lL2hvbWUubW9kdWxlLmpzIiwiY29tcG9uZW50cy9zZW1lc3RlcnMvc2VtZXN0ZXJzLm1vZHVsZS5qcyIsInJvb3QuY29tcG9uZW50LmpzIiwiY29tbW9uL2FwcC1uYXYuY29tcG9uZW50LmpzIiwiY29tbW9uL2FwcC5jb21wb25lbnQuanMiLCJjb21tb24vYXBwLmNvbmZpZy5qcyIsImNvbW1vbi9hcHAuY29udHJvbGxlci5qcyIsImNvbW1vbi9hcHAucnVuLmpzIiwiY29tbW9uL3NlcnZpY2VzL0NvdXJzZS5tb2RlbC5qcyIsImNvbW1vbi9zZXJ2aWNlcy9qc29uLnNlcnZpY2UuanMiLCJjb21tb24vc2VydmljZXMvTWFqb3IubW9kZWwuanMiLCJjb21wb25lbnRzL2hvbWUvaG9tZS5jb21wb25lbnQuanMiLCJjb21wb25lbnRzL2hvbWUvaG9tZS5jb250cm9sbGVyLmpzIiwiY29tcG9uZW50cy9zZW1lc3RlcnMvc2VtZXN0ZXJzLmNvbXBvbmVudC5qcyIsImNvbXBvbmVudHMvc2VtZXN0ZXJzL3NlbWVzdGVycy5jb250cm9sbGVyLmpzIiwidGVtcGxhdGVzLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLENBQUEsU0FBQSxRQUFBO0FBQ0E7QUFDQTtLQUNBLE9BQUEsUUFBQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1VBQ0EsT0FBQTtBQ1JBLENBQUEsU0FBQSxRQUFBO0FBQ0E7QUFDQTtHQUNBLE9BQUEsVUFBQTtJQUNBO0lBQ0E7SUFDQTs7R0FFQSxJQUFBLFlBQUE7SUFDQSxRQUFBLElBQUE7UUFDQSxPQUFBO0FDVkEsQ0FBQSxTQUFBLFFBQUE7QUFDQTtBQUNBO0tBQ0EsT0FBQTtJQUNBLENBQUE7SUFDQTtJQUNBO09BQ0EsT0FBQTtBQ1BBLENBQUEsU0FBQSxRQUFBO0FBQ0E7QUFD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QSxLQUFBLFNBQUEsU0FBQTtZQUNBLEtBQUEsSUFBQSxJQUFBLEdBQUEsSUFBQSxRQUFBLFFBQUEsT0FBQTtnQkFDQSxJQUFBLFlBQUEsUUFBQSxLQUFBLFdBQUE7Z0JBQ0EsS0FBQSxPQUFBLFVBQUEsR0FBQSxLQUFBO2dCQUNBLEtBQUEsT0FBQSxRQUFBLGFBQUEsUUFBQSxLQUFBLFdBQUE7Z0JBQ0EsS0FBQSxPQUFBLE1BQUEsYUFBQSxRQUFBLEtBQUEsV0FBQTtnQkFDQSxLQUFBLE9BQUEsUUFBQSxhQUFBLFFBQUEsS0FBQSxXQUFBO2dCQUNBLEtBQUEsT0FBQSxZQUFBLE1BQUEsUUFBQSxLQUFBLFdBQUE7Ozs7O1FBS0EsV0FBQSxZQUFBLGVBQUEsR0FBQSxLQUFBLFNBQUEsU0FBQTtZQUNBLEtBQUEsSUFBQSxJQUFBLEdBQUEsSUFBQSxRQUFBLFFBQUEsT0FBQTtnQkFDQSxJQUFBLFlBQUEsUUFBQSxLQUFBLFdBQUE7Z0JBQ0EsS0FBQSxPQUFBLFVBQUEsR0FBQSxLQUFBO2dCQUNBLEtBQUEsT0FBQSxRQUFBLGFBQUEsUUFBQSxLQUFBLFdBQUE7Z0JBQ0EsS0FBQSxPQUFBLE1BQUEsYUFBQSxRQUFBLEtBQUEsV0FBQTtnQkFDQSxLQUFBLE9BQUEsUUFBQSxhQUFBLFFBQUEsS0FBQSxXQUFBO2dCQUNBLEtBQUEsT0FBQSxZQUFBLE1BQUEsUUFBQSxLQUFBLFdBQUE7Ozs7O1FBS0EsV0FBQSxZQUFBLGVBQUEsR0FBQSxLQUFBLFNBQUEsU0FBQTtZQUNBLEtBQUEsSUFBQSxJQUFBLEdBQUEsSUFBQSxRQUFBLFFBQUEsT0FBQTtnQkFDQSxJQUFBLFlBQUEsUUFBQSxLQUFBLFdBQUE7Z0JBQ0EsS0FBQSxPQUFBLFVBQUEsR0FBQSxLQUFBO2dCQUNBLEtBQUEsT0FBQSxRQUFBLGFBQUEsUUFBQSxLQUFBLFdBQUE7Z0JBQ0EsS0FBQSxPQUFBLE1BQUEsYUFBQSxRQUFBLEtBQUEsV0FBQTtnQkFDQSxLQUFBLE9BQUEsUUFBQSxhQUFBLFFBQUEsS0FBQSxXQUFBO2dCQUNBLEtBQUEsT0FBQSxZQUFBLE1BQUEsUUFBQSxLQUFBLFdBQUE7Ozs7O1FBS0EsV0FBQSxZQUFBLGVBQUEsR0FBQSxLQUFBLFNBQUEsU0FBQTtZQUNBLEtBQUEsSUFBQSxJQUFBLEdBQUEsSUFBQSxRQUFBLFFBQUEsT0FBQTtnQkFDQSxJQUFBLFlBQUEsUUFBQSxLQUFBLFdBQUE7Z0JBQ0EsS0FBQSxPQUFBLFVBQUEsR0FBQSxLQUFBO2dCQUNBLEtBQUEsT0FBQSxRQUFBLGFBQUEsUUFBQSxLQUFBLFdBQUE7Z0JBQ0EsS0FBQSxPQUFBLE1BQUEsYUFBQSxRQUFBLEtBQUEsV0FBQTtnQkFDQSxLQUFBLE9BQUEsUUFBQSxhQUFBLFFBQUEsS0FBQSxXQUFBO2dCQUNBLEtBQUEsT0FBQSxZQUFBLE1BQUEsUUFBQSxLQUFBLFdBQUE7Ozs7O1FBS0EsV0FBQSxZQUFBLGVBQUEsR0FBQSxLQUFBLFNBQUEsU0FBQTtZQUNBLEtBQUEsSUFBQSxJQUFBLEdBQUEsSUFBQSxRQUFBLFFBQUEsT0FBQTtnQkFDQSxJQUFBLFlBQUEsUUFBQSxLQUFBLFdBQUE7Z0JBQ0EsS0FBQSxPQUFBLFVBQUEsR0FBQSxLQUFBO2dCQUNBLEtBQUEsT0FBQSxRQUFBLGFBQUEsUUFBQSxLQUFBLFdBQUE7Z0JBQ0EsS0FBQSxPQUFBLE1BQUEsYUFBQSxRQUFBLEtBQUEsV0FBQTtnQkFDQSxLQUFBLE9BQUEsUUFBQSxhQUFBLFFBQUEsS0FBQSxXQUFBO2dCQUNBLEtBQUEsT0FBQSxZQUFBLE1BQUEsUUFBQSxLQUFBLFdBQUE7Ozs7O1FBS0EsV0FBQSxZQUFBLGVBQUEsR0FBQSxLQUFBLFNBQUEsU0FBQTtZQUNBLEtBQUEsSUFBQSxJQUFBLEdBQUEsSUFBQSxRQUFBLFFBQUEsT0FBQTtnQkFDQSxJQUFBLFlBQUEsUUFBQSxLQUFBLFdBQUE7Z0JBQ0EsS0FBQSxPQUFBLFVBQUEsR0FBQSxLQUFBO2dCQUNBLEtBQUEsT0FBQSxRQUFBLGFBQUEsUUFBQSxLQUFBLFdBQUE7Z0JBQ0EsS0FBQSxPQUFBLE1BQUEsYUFBQSxRQUFBLEtBQUEsV0FBQTtnQkFDQSxLQUFBLE9BQUEsUUFB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LE9BQUE7QUNuYUEsQ0FBQSxTQUFBLFFBQUE7QUFDQTtBQUNBLFFBQUEsT0FBQSxhQUFBLElBQUEsSUFBQSxDQUFBLGtCQUFBLFNBQUEsZ0JBQUEsQ0FBQSxlQUFBLElBQUEsY0FBQTtBQUNBLGVBQUEsSUFBQSxpQkFBQTtBQUNBLGVBQUEsSUFBQSxhQUFBO0FBQ0EsZUFBQSxJQUFBLGNBQUE7QUFDQSxlQUFBLElBQUEsa0JBQUE7QUFDQSxlQUFBLElBQUEscUJBQUE7QUFDQSxlQUFBLElBQUEsbUJBQUEsMGpFQUFBLE9BQUEsU0FBQSIsImZpbGUiOiJtYWluLTE1ODc5NDI1MDk0OTEubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhclxyXG4gICAgLm1vZHVsZSgncm9vdCcsIFtcclxuICAgICAgICAnY29tbW9uJyxcclxuICAgICAgICAnY29tcG9uZW50cycsXHJcbiAgICAgICAgJ3RlbXBsYXRlcycsXHJcbiAgICAgICAgJ25nTWF0ZXJpYWwnXHJcbiAgICBdKTsiLCJhbmd1bGFyXHJcbiAgLm1vZHVsZSgnY29tbW9uJywgW1xyXG4gICAgJ3VpLnJvdXRlcicsXHJcbiAgICAnbmdNYXRlcmlhbCcsXHJcbiAgICAnbmdQYXJzZScsXHJcbiAgXSlcclxuICAucnVuKGZ1bmN0aW9uICgpIHtcclxuICAgIGNvbnNvbGUubG9nKFwiY29tbW9uIG1vZHVsZVwiKVxyXG4gIH0pOyIsImFuZ3VsYXIgXHJcbiAgICAubW9kdWxlKCdjb21wb25lbnRzJywgXHJcbiAgICBbJ2NvbXBvbmVudHMuaG9tZScsXHJcbiAgICAnY29tcG9uZW50cy5zZW1lc3RlcnMnLFxyXG4gICAgJ25nTWF0ZXJpYWwnXHJcbl0pOyAiLCJhbmd1bGFyXHJcbiAgICAubW9kdWxlKCdjb21wb25lbnRzLmhvbWUnLCBbXHJcbiAgICAgICAgJ3VpLnJvdXRlcicsXHJcbiAgICAgICAgJ25nTWF0ZXJpYWwnXHJcbiAgICAgICAgXHJcbiAgICBdKTsiLCJhbmd1bGFyXHJcbiAgICAubW9kdWxlKCdjb21wb25lbnRzLnNlbWVzdGVycycsIFtcclxuICAgICAgICAndWkucm91dGVyJyxcclxuICAgICAgICAnbmdNYXRlcmlhbCcsXHJcbiAgICAgICAgJ3VpLnNvcnRhYmxlJ1xyXG4gICAgICAgIFxyXG4gICAgXSk7IiwidmFyIHJvb3QgPSB7XHJcbiAgICB0ZW1wbGF0ZVVybDogJy4vcm9vdC5odG1sJ1xyXG4gIH07XHJcbiAgXHJcbiAgYW5ndWxhclxyXG4gICAgLm1vZHVsZSgncm9vdCcpXHJcbiAgICAuY29tcG9uZW50KCdyb290Jywgcm9vdCk7XHJcblxyXG5cclxuXHJcbiIsInZhciBhcHBOYXYgPSB7XHJcbiAgICB0ZW1wbGF0ZVVybDogJy4vYXBwLW5hdi5odG1sJ1xyXG4gIH07XHJcbiAgXHJcbiAgYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnY29tbW9uJylcclxuICAgIC5jb21wb25lbnQoJ2FwcE5hdicsIGFwcE5hdik7IiwidmFyIGFwcCA9IHtcclxuICAgIHRlbXBsYXRlVXJsOiAnLi9hcHAuaHRtbCcsXHJcbiAgICBjb250cm9sbGVyOiAnQXBwQ29udHJvbGxlcidcclxuICB9O1xyXG4gIFxyXG4gIGFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ2NvbW1vbicpXHJcbiAgICAuY29tcG9uZW50KCdhcHAnLCBhcHApXHJcbiAgICAuY29uZmlnKGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xyXG4gICAgICAkc3RhdGVQcm92aWRlclxyXG4gICAgICAgIC5zdGF0ZSgnYXBwJywge1xyXG4gICAgICAgICAgICAgIHJlZGlyZWN0VG86ICBcImhvbWVcIixcclxuICAgICAgICAgICAgICB1cmw6ICcvJyxcclxuICAgICAgICAgICAgICBjb21wb25lbnQ6ICdhcHAnLFxyXG5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgXHJcbiAgICAgICAgKVxyXG4gICAgfSk7IiwiZnVuY3Rpb24gY29uZmlnKFBhcnNlUHJvdmlkZXIsICRsb2NhdGlvblByb3ZpZGVyKSB7XHJcbiAgUGFyc2VQcm92aWRlci5zZXJ2ZXJVUkwgPSAnaHR0cHM6Ly9wYXJzZWFwaS5iYWNrNGFwcC5jb20nOyAvLyBUaGlzIGlzIHlvdXIgU2VydmVyIFVSTFxyXG4gIFBhcnNlUHJvdmlkZXIuaW5pdGlhbGl6ZShcclxuICAgICdVWndwRmJHWVBXR0dLc1ZBdDV2UnpQYkgxbFNkWDZ1NzdPRjNLckQ1JywgLy8gVGhpcyBpcyB5b3VyIEFwcGxpY2F0aW9uIElEXHJcbiAgICAnSXBLNmp5emRTU09HZnFmTTVTYkE5MFVtYWtqTENoZmJFamNhUEZCUycgLy8gVGhpcyBpcyB5b3VyIEphdmFzY3JpcHQga2V5XHJcbiAgKTtcclxuICAkbG9jYXRpb25Qcm92aWRlci5oYXNoUHJlZml4KCcnKTtcclxufVxyXG5cclxuYW5ndWxhci5tb2R1bGUoJ2NvbW1vbicpLmNvbmZpZyhjb25maWcpOyIsImZ1bmN0aW9uIEFwcENvbnRyb2xsZXIoJHN0YXRlKSB7XHJcbiAgICB2YXIgY3RybCA9IHRoaXM7XHJcbiAgICBjb25zb2xlLmxvZyhcImFwcCBjb250cm9sbGVyXCIpXHJcbiAgfVxyXG4gIFxyXG4gIGFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ2NvbW1vbicpXHJcbiAgICAuY29udHJvbGxlcignQXBwQ29udHJvbGxlcicsIEFwcENvbnRyb2xsZXIpOyIsImZ1bmN0aW9uIGluaXQoICR1aVJvdXRlcil7XHJcbiAgICB2YXIgVmlzdWFsaXplciA9IHdpbmRvd1sndWktcm91dGVyLXZpc3VhbGl6ZXInXS5WaXN1YWxpemVyO1xyXG4gICAgdmFyIHBsdWdJbnN0YW5jZSA9ICR1aVJvdXRlci5wbHVnaW4oVmlzdWFsaXplcik7XHJcbn1cclxuXHJcbmFuZ3VsYXIubW9kdWxlKCdjb21tb24nKS5ydW4oaW5pdCkiLCIvKipcclxuICogQG5nZG9jIHNlcnZpY2VcclxuICogQG5hbWUgY29tbW9uLnNlcnZpY2U6Q291cnNlTW9kZWxcclxuICpcclxuICogQGRlc2NyaXB0aW9uIE1vZGVsIGFuZCBoZWxwZXIgbWV0aG9kcyBmb3IgQ291cnNlTW9kZWwgcGFyc2Ugb2JqZWN0LlxyXG4gKi9cclxuXHJcbmNsYXNzIENvdXJzZU1vZGVsIHtcclxuICAgIGNvbnN0cnVjdG9yKFBhcnNlLCBNYWpvck1vZGVsKSB7XHJcbiAgICAgICAgdGhpcy5QYXJzZSA9IFBhcnNlO1xyXG4gICAgICAgIHRoaXMuTWFqb3JNb2RlbCA9IE1ham9yTW9kZWxcclxuICAgICAgICB0aGlzLmRhdGEgPSB7fTtcclxuICAgICAgICB0aGlzLmNvbGxlY3Rpb24gPSBbXTtcclxuICAgICAgICB0aGlzLm5hbWUgPSAnQ291cnNlJztcclxuICAgICAgICB0aGlzLmZpZWxkcyA9IFtcclxuICAgICAgICAgICAgJ2NvdXJzZU5hbWUnLFxyXG4gICAgICAgICAgICAnY29yZXF1aXNpdGVzJyxcclxuICAgICAgICAgICAgJ3NlbWVzdGVyRGVmYXVsdCcsIFxyXG4gICAgICAgICAgICAnY291cnNlSWQnLFxyXG4gICAgICAgICAgICAnc2VtZXN0ZXJSZXF1aXJlZCcsXHJcbiAgICAgICAgICAgICdhdHRyaWJ1dGVzJyxcclxuICAgICAgICAgICAgJ2RlZmF1bHRNYWpvcicsXHJcbiAgICAgICAgICAgICdjcmVkaXRzJyxcclxuICAgICAgICAgICAgJ3ByZXJlcXVpc2l0ZXMnXHJcbiAgICAgICAgXTtcclxuICAgIH1cclxuICAgIE5ldyhvYmopIHtcclxuICAgICAgICBpZiAoYW5ndWxhci5pc1VuZGVmaW5lZChvYmopKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBhcnNlT2JqZWN0ID0gbmV3IHRoaXMuUGFyc2UuT2JqZWN0KHRoaXMubmFtZSk7XHJcbiAgICAgICAgICAgIHRoaXMuUGFyc2UuZGVmaW5lQXR0cmlidXRlcyhwYXJzZU9iamVjdCwgdGhpcy5maWVsZHMpO1xyXG4gICAgICAgICAgICAvLyBwYXJzZU9iamVjdC5tYWpvciA9IG5ldyB0aGlzLlBhcnNlLk9iamVjdCh0aGlzLk1ham9yTW9kZWwubmFtZSlcclxuICAgICAgICAgICAgLy8gdGhpcy5QYXJzZS5kZWZpbmVBdHRyaWJ1dGVzKHBhcnNlT2JqZWN0Lm1ham9yKTsgXHJcbiAgICAgICAgICAgIHJldHVybiBwYXJzZU9iamVjdDtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLlBhcnNlLmRlZmluZUF0dHJpYnV0ZXMob2JqLCB0aGlzLmZpZWxkcyk7XHJcbiAgICAgICAgICAgIC8vIHRoaXMuUGFyc2UuZGVmaW5lQXR0cmlidXRlcyhvYmoubWFqb3IsIHRoaXMuTWFqb3JNb2RlbC5maWVsZHMpOyBcclxuICAgICAgICAgICAgcmV0dXJuIG9iajtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBnZXRCeUlkKGlkKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coaWQpXHJcbiAgICAgICAgcmV0dXJuIG5ldyB0aGlzLlBhcnNlLlF1ZXJ5KHRoaXMuTmV3KCkpXHJcbiAgICAgICAgICAgIC5lcXVhbFRvKFwib2JqZWN0SWRcIiwgaWQpXHJcbiAgICAgICAgICAgIC5maW5kKClcclxuICAgICAgICAgICAgLnRoZW4ocmVzdWx0ID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyZXN1bHQnLCByZXN1bHQpXHJcbiAgICAgICAgICAgICAgICB0aGlzLlBhcnNlLmRlZmluZUF0dHJpYnV0ZXMocmVzdWx0LCB0aGlzLmZpZWxkcyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRhdGEgPSByZXN1bHQ7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHJlc3VsdCk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5jYXRjaChlcnJvciA9PiBQcm9taXNlLnJlamVjdChlcnJvcikpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldEJ5TmFtZShuYW1lKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJuYW1lIHBhc3NlZCBpbjogXCIsIG5hbWUpXHJcbiAgICAgICAgcmV0dXJuIG5ldyB0aGlzLlBhcnNlLlF1ZXJ5KHRoaXMuTmV3KCkpXHJcbiAgICAgICAgICAgIC5lcXVhbFRvKFwiY291cnNlTmFtZVwiLCBuYW1lKVxyXG4gICAgICAgICAgICAuZmluZCgpXHJcbiAgICAgICAgICAgIC50aGVuKHJlc3VsdCA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygncmVzdWx0OiAnLCByZXN1bHRbMF0pOyAgICAgICAgIC8vIG5vIHR3byBjb3Vyc2VzIHNob3VsZCBoYXZlIHRoZSBzYW1lIG5hbWVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBzbyBzaG91bGQgb25seSBiZSBvbmUgcmVzdWx0XHJcbiAgICAgICAgICAgICAgICAvL3RoaXMuUGFyc2UuZGVmaW5lQXR0cmlidXRlcyhyZXN1bHRbMF0sIHRoaXMuZmllbGRzKTsgXHJcbiAgICAgICAgICAgICAgICAvL3RoaXMuZGF0YSA9IHJlc3VsdFswXTsgXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHJlc3VsdFswXSk7IFxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2F0Y2goZXJyb3IgPT4gUHJvbWlzZS5yZWplY3QoZXJyb3IpKVxyXG4gICAgfVxyXG5cclxuICAgIGdldEJ5TWFqb3IobWFqb3IpIHtcclxuICAgICAgICByZXR1cm4gbmV3IHRoaXMuUGFyc2UuUXVlcnkodGhpcy5OZXcoKSlcclxuICAgICAgICAgICAgLmluY2x1ZGUoJ21ham9yJylcclxuICAgICAgICAgICAgLmVxdWFsVG8oJ21ham9yJywgbWFqb3IpXHJcbiAgICAgICAgICAgIC5maW5kKClcclxuICAgICAgICAgICAgLnRoZW4oY291cnNlcyA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb3Vyc2VzLmZvckVhY2goY291cnNlID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLlBhcnNlLmRlZmluZUF0dHJpYnV0ZXMoY291cnNlLCB0aGlzLmZpZWxkcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5QYXJzZS5kZWZpbmVBdHRyaWJ1dGVzKGNvdXJzZS5tYWpvciwgdGhpcy5Db3Vyc2VNb2RlbC5maWVsZHMpO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIHRoaXMuY29sbGVjdGlvbiA9IGNvdXJzZXM7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImdldEJ5TWFqb3JcIiwgdGhpcy5jb2xsZWN0aW9uKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShjb3Vyc2VzKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLmNhdGNoKGVycm9yID0+IFByb21pc2UucmVqZWN0KGVycm9yKSk7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0U2VtZXN0ZXJEZWZhdWx0KGlkLCBzZW0pIHtcclxuICAgICAgICAvL215b2JqID0gbmV3IHRoaXMuUGFyc2UuUXVlcnkodGhpcy5OZXcoKSlcclxuICAgICAgICByZXR1cm4gbmV3IHRoaXMuUGFyc2UuUXVlcnkodGhpcy5OZXcoKSlcclxuICAgICAgICAgICAgLmdldChpZClcclxuICAgICAgICAgICAgLnRoZW4ocmVzdWx0ID0+IHtcclxuICAgICAgICAgICAgICAgIC8vIHRoaXMuUGFyc2UuZGVmaW5lQXR0cmlidXRlcyhyZXN1bHQsIHRoaXMuZmllbGRzKTtcclxuICAgICAgICAgICAgICAgIC8vIHRoaXMuZGF0YSA9IHJlc3VsdDsgXHJcbiAgICAgICAgICAgICAgICByZXN1bHQuc2V0KFwic2VtZXN0ZXJEZWZhdWx0XCIsIHNlbSk7IFxyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ25ldyBkZWZhdWx0IHNob3VsZCBiZSAzOiAnLCByZXN1bHQpOyBcclxuICAgICAgICAgICAgICAgIHJlc3VsdC5zYXZlKCk7IFxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShyZXN1bHQpOyBcclxuICAgICAgICAgICAgfSkuY2F0Y2goZXJyb3IgPT4gUHJvbWlzZS5yZWplY3QoZXJyb3IpKVxyXG4gICAgfVxyXG5cclxuICAgIHJlbW92ZVNlbWVzdGVyRGVmYXVsdChpZCkge1xyXG4gICAgICAgIC8vbXlvYmogPSBuZXcgdGhpcy5QYXJzZS5RdWVyeSh0aGlzLk5ldygpKVxyXG4gICAgICAgIHJldHVybiBuZXcgdGhpcy5QYXJzZS5RdWVyeSh0aGlzLk5ldygpKVxyXG4gICAgICAgICAgICAuZ2V0KGlkKVxyXG4gICAgICAgICAgICAudGhlbihyZXN1bHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgLy8gdGhpcy5QYXJzZS5kZWZpbmVBdHRyaWJ1dGVzKHJlc3VsdCwgdGhpcy5maWVsZHMpO1xyXG4gICAgICAgICAgICAgICAgLy8gdGhpcy5kYXRhID0gcmVzdWx0OyBcclxuICAgICAgICAgICAgICAgIHJlc3VsdC5zZXQoXCJzZW1lc3RlckRlZmF1bHRcIiwgbnVsbCk7IFxyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ25ldyBkZWZhdWx0IHNob3VsZCBiZSAzOiAnLCByZXN1bHQpOyBcclxuICAgICAgICAgICAgICAgIHJlc3VsdC5zYXZlKCk7IFxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShyZXN1bHQpOyBcclxuICAgICAgICAgICAgfSkuY2F0Y2goZXJyb3IgPT4gUHJvbWlzZS5yZWplY3QoZXJyb3IpKVxyXG4gICAgfVxyXG5cclxuICAgIGdldENvdXJzZUJ5U2VtKHNlbURlZikge1xyXG4gICAgICAgIHJldHVybiBuZXcgdGhpcy5QYXJzZS5RdWVyeSh0aGlzLk5ldygpKVxyXG4gICAgICAgICAgICAuZXF1YWxUbyhcInNlbWVzdGVyRGVmYXVsdFwiLCBzZW1EZWYpXHJcbiAgICAgICAgICAgIC5maW5kKCkudGhlbihyZXN1bHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kYXRhID0gcmVzdWx0O1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJyZXN1bHQgb2YgZ2V0Q291cnNlQnlTZW06IFwiLCByZXN1bHQpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShyZXN1bHQpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2F0Y2goZXJyb3IgPT4gUHJvbWlzZS5yZWplY3QoZXJyb3IpKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRDb3Vyc2VzKCkge1xyXG4gICAgICAgIHJldHVybiBuZXcgdGhpcy5QYXJzZS5RdWVyeSh0aGlzLk5ldygpKVxyXG4gICAgICAgICAgICAuZmluZCgpLnRoZW4ocmVzdWx0ID0+IHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUocmVzdWx0KTsgXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5jYXRjaChlcnJvciA9PiBQcm9taXNlLnJlamVjdChlcnJvcikpOyBcclxuICAgIH1cclxufVxyXG5cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnY29tbW9uJylcclxuICAgIC5zZXJ2aWNlKCdDb3Vyc2VNb2RlbCcsIENvdXJzZU1vZGVsKTtcclxuIiwiY2xhc3MgSlNPTlNlcnZpY2Uge1xyXG4gICAgY29uc3RydWN0b3IoJGh0dHApe1xyXG4gICAgICAgIHRoaXMuJGh0dHAgPSAkaHR0cFxyXG4gICAgfVxyXG5cclxuICAgIGdldFNlbWVzdGVyRGF0YSgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy4kaHR0cCh7XHJcbiAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXHJcbiAgICAgICAgICAgIHVybDogJy4uL2RhdGEuanNvbicsXHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuICAgIGdldENsYXNzRGF0YSgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy4kaHR0cCh7XHJcbiAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXHJcbiAgICAgICAgICAgIHVybDogJy4uL2FkZENsYXNzLmpzb24nLFxyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG59XHJcblxyXG5hbmd1bGFyXHJcbiAgICAubW9kdWxlKCdjb21tb24nKVxyXG4gICAgLnNlcnZpY2UoJ0pTT05TZXJ2aWNlJywgSlNPTlNlcnZpY2UpOyIsIi8qKlxyXG4gKiBAbmdkb2Mgc2VydmljZVxyXG4gKiBAbmFtZSBjb21tb24uc2VydmljZTpNYWpvck1vZGVsXHJcbiAqXHJcbiAqIEBkZXNjcmlwdGlvbiBNb2RlbCBhbmQgaGVscGVyIG1ldGhvZHMgZm9yIE1ham9yTW9kZWwgcGFyc2Ugb2JqZWN0LlxyXG4gKi9cclxuXHJcbmNsYXNzIE1ham9yTW9kZWwge1xyXG4gICAgY29uc3RydWN0b3IoUGFyc2UpIHtcclxuICAgICAgICB0aGlzLlBhcnNlID0gUGFyc2U7XHJcbiAgICAgICAgdGhpcy5kYXRhID0ge307XHJcbiAgICAgICAgdGhpcy5jb2xsZWN0aW9uID0gW107XHJcbiAgICAgICAgdGhpcy5uYW1lID0gJ01ham9yJztcclxuICAgICAgICB0aGlzLmZpZWxkcyA9IFtcclxuICAgICAgICAgICAgJ2NyZWRpdHMnLFxyXG4gICAgICAgICAgICAnbWFqb3JOYW1lJyxcclxuICAgICAgICAgICAgJ2NvbGxlZ2UnXHJcbiAgICAgICAgXTtcclxuICAgIH1cclxuICAgIE5ldyhvYmopIHtcclxuICAgICAgICBpZiAoYW5ndWxhci5pc1VuZGVmaW5lZChvYmopKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBhcnNlT2JqZWN0ID0gbmV3IHRoaXMuUGFyc2UuT2JqZWN0KHRoaXMubmFtZSlcclxuICAgICAgICAgICAgdGhpcy5QYXJzZS5kZWZpbmVBdHRyaWJ1dGVzKHBhcnNlT2JqZWN0LCB0aGlzLmZpZWxkcyk7XHJcbiAgICAgICAgICAgIHJldHVybiBwYXJzZU9iamVjdDtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLlBhcnNlLmRlZmluZUF0dHJpYnV0ZXMob2JqLCB0aGlzLmZpZWxkcyk7XHJcbiAgICAgICAgICAgIHJldHVybiBvYmo7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZ2V0QnlJZChpZCkge1xyXG4gICAgICAgIHJldHVybiBuZXcgdGhpcy5QYXJzZS5RdWVyeSh0aGlzLk5ldygpKVxyXG4gICAgICAgICAgICAuZ2V0KGlkKVxyXG4gICAgICAgICAgICAudGhlbihyZXN1bHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3Jlc3VsdCcsIHJlc3VsdClcclxuICAgICAgICAgICAgICAgIHRoaXMuUGFyc2UuZGVmaW5lQXR0cmlidXRlcyhyZXN1bHQsIHRoaXMuZmllbGRzKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGF0YSA9IHJlc3VsdDtcclxuICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUocmVzdWx0KTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLmNhdGNoKGVycm9yID0+IFByb21pc2UucmVqZWN0KGVycm9yKSk7XHJcbiAgICB9XHJcbiAgICBnZXRCeU5hbWUobmFtZSkge1xyXG4gICAgICAgIHJldHVybiBuZXcgdGhpcy5QYXJzZS5RdWVyeSh0aGlzLk5ldygpKVxyXG4gICAgICAgICAgICAuZXF1YWxUbyhcIm1ham9yTmFtZVwiLCBuYW1lKVxyXG4gICAgICAgICAgICAuZmluZCgpLnRoZW4ocmVzdWx0ID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyZXN1bHQnLCByZXN1bHQpXHJcbiAgICAgICAgICAgICAgICB0aGlzLlBhcnNlLmRlZmluZUF0dHJpYnV0ZXMocmVzdWx0LCB0aGlzLmZpZWxkcyk7IFxyXG4gICAgICAgICAgICAgICAgdGhpcy5kYXRhID0gcmVzdWx0OyBcclxuICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUocmVzdWx0KTsgXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5jYXRjaChlcnJvciA9PiBQcm9taXNlLnJlamVjdChlcnJvcikpXHJcbiAgICB9XHJcbiAgICBnZXRNYWpvcnMoKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyB0aGlzLlBhcnNlLlF1ZXJ5KHRoaXMuTmV3KCkpXHJcbiAgICAgICAgLmZpbmQoKS50aGVuKHJlc3VsdCA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuZGF0YSA9IHJlc3VsdFxyXG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHJlc3VsdCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuY2F0Y2goZXJyb3IgPT4gUHJvbWlzZS5yZWplY3QoZXJyb3IpKTtcclxuICAgIH1cclxufVxyXG5cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnY29tbW9uJylcclxuICAgIC5zZXJ2aWNlKCdNYWpvck1vZGVsJywgTWFqb3JNb2RlbCk7XHJcbiIsInZhciBob21lID0ge1xyXG4gICAgdGVtcGxhdGVVcmw6ICcuL2hvbWUuaHRtbCcsXHJcbiAgICBjb250cm9sbGVyOiAnSG9tZUNvbnRyb2xsZXInLFxyXG5cclxufVxyXG5cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnY29tcG9uZW50cy5ob21lJylcclxuICAgIC5jb21wb25lbnQoJ2hvbWUnLCBob21lKVxyXG4gICAgLmNvbmZpZyhmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlcikge1xyXG4gICAgICAgICRzdGF0ZVByb3ZpZGVyLnN0YXRlKCdob21lJywge1xyXG4gICAgICAgICAgICBwYXJlbnQ6ICdhcHAnLFxyXG4gICAgICAgICAgICB1cmw6ICdob21lJyxcclxuICAgICAgICAgICAgY29tcG9uZW50OiAnaG9tZSdcclxuICAgICAgICB9KVxyXG4gICAgJHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZSgnLycpO1xyXG4gICAgfSk7IFxyXG5cclxuICAgICIsIlxyXG4vKipcclxuICogQG5nZG9jcyBkaXJlY3RpdmVcclxuICogXHJcbiAqIEBmdW5jdGlvbiBIb21lQ29udHJvbGxlclxyXG4gKiBcclxuICogQHBhcmFtIHsqfSAkc3RhdGUgXHJcbiAqIEBwYXJhbSB7Kn0gTWFqb3JNb2RlbCBcclxuICogXHJcbiAqIEBkZXNjcmlwdGlvblxyXG4gKiBIb21lIGNvbnRyb2xsZXIgZm9yIHRoZSBmaXJzdCBwYWdlIHdoaWNoIGRpc3BsYXlzIHRoZSBtYWpvciBvcHRpb25zIGluIHRoZSBkcm9wZG93biBsaXN0LlxyXG4gKi9cclxuXHJcbmZ1bmN0aW9uIEhvbWVDb250cm9sbGVyKCRzdGF0ZSwgTWFqb3JNb2RlbCkge1xyXG4gICAgdmFyIGN0cmwgPSB0aGlzO1xyXG4gICAgICB0aGlzLiRvbkluaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKFwiaG9tZSBjb250cm9sbGVyXCIpXHJcbiAgICAgIGxldCBtYWpvcnNfbGlzdCA9IFtdXHJcbiAgICAgIE1ham9yTW9kZWwuZ2V0TWFqb3JzKCkudGhlbihmdW5jdGlvbihtYWpvcnMpIHtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG1ham9ycy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgbWFqb3JzX2xpc3QucHVzaChtYWpvcnNbaV0uYXR0cmlidXRlcy5tYWpvck5hbWUpXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGN0cmwubWFqb3JzID0gbWFqb3JzX2xpc3Q7XHJcbiAgICAgIH0pXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuXHJcbmFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ2NvbXBvbmVudHMuaG9tZScpXHJcbiAgICAuY29udHJvbGxlcignSG9tZUNvbnRyb2xsZXInLCBIb21lQ29udHJvbGxlcik7IiwidmFyIHNlbWVzdGVycyA9IHtcclxuICAgIHRlbXBsYXRlVXJsOiAnLi9zZW1lc3RlcnMuaHRtbCcsXHJcbiAgICBjb250cm9sbGVyOiAnU2VtZXN0ZXJzQ29udHJvbGxlcicsXHJcblxyXG59XHJcblxyXG5hbmd1bGFyXHJcbiAgICAubW9kdWxlKCdjb21wb25lbnRzLnNlbWVzdGVycycpXHJcbiAgICAuY29tcG9uZW50KCdzZW1lc3RlcnMnLCBzZW1lc3RlcnMpXHJcbiAgICAuY29uZmlnKGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xyXG4gICAgICAgICRzdGF0ZVByb3ZpZGVyLnN0YXRlKCdzZW1lc3RlcnMnLCB7XHJcbiAgICAgICAgICAgIHBhcmVudDogJ2FwcCcsXHJcbiAgICAgICAgICAgIHVybDogJ3NlbWVzdGVycycsXHJcbiAgICAgICAgICAgIGNvbXBvbmVudDogJ3NlbWVzdGVycydcclxuICAgICAgICB9KVxyXG4gICAgfSlcclxuXHJcbiAgICAiLCIvKipcclxuICogQG5nZG9jIGRpcmVjdGl2ZSBcclxuICogXHJcbiAqIEBmdW5jdGlvbiBTZW1lc3RlcnNDb250cm9sbGVyXHJcbiAqIFxyXG4gKiBAcGFyYW0geyp9ICRodHRwIFxyXG4gKiBAcGFyYW0geyp9ICRtZERpYWxvZyBcclxuICogQHBhcmFtIHsqfSBKU09OU2VydmljZSBcclxuICogQHBhcmFtIHsqfSBDb3Vyc2VNb2RlbCBcclxuICogQHBhcmFtIHsqfSAkd2luZG93IFxyXG4gKiBcclxuICogQGRlc2NyaXB0aW9uXHJcbiAqIFRoZSBzZW1lc3RlcnMgY29udHJvbGxlciBpcyB1c2VkIGZvciB0aGUgc2VtZXN0ZXJzIHBhZ2UuIFxyXG4gKi9cclxuXHJcbmZ1bmN0aW9uIFNlbWVzdGVyc0NvbnRyb2xsZXIoJGh0dHAsICRtZERpYWxvZywgSlNPTlNlcnZpY2UsIENvdXJzZU1vZGVsLCAkd2luZG93KSB7XHJcbiAgICB2YXIgY3RybCA9IHRoaXM7XHJcbiAgICBjb25zb2xlLmxvZyhcInNlbWVzdGVycyBjb250cm9sbGVyXCIpXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAbmdkb2MgZGlyZWN0aXZlXHJcbiAgICAgKiBAZnVuY3Rpb24gcG9wdWxhdGVMaXN0cyBcclxuICAgICAqIEBwYXJhbSB7Kn0gQ291cnNlTW9kZWxcclxuICAgICAqIFxyXG4gICAgICogQGRlc2NyaXB0aW9uXHJcbiAgICAgKiBUaGlzIGZ1bmN0aW9uIGlzIHVzZWQgdG8gZ2VuZXJhdGUgYWxsIDggc2VtZXN0ZXJzIG9uIHRoZSBzZW1lc3RlcnMgcGFnZS4gRm9yIGVhY2ggc2VtZXN0ZXIsIGlmIGEgY2xhc3MnIFxyXG4gICAgICogZGVmYXVsdCBzZW1lc3RlciBpcyBzZXQgdG8gdGhhdCBzcGVjaWZpYyBzZW1lc3RlciB0aGUgY2xhc3MgZ2V0cyBhZGRlZCB0byB0aGF0IHNlbWVzdGVyLlxyXG4gICAgICovXHJcblxyXG4gICAgZnVuY3Rpb24gcG9wdWxhdGVMaXN0cyhDb3Vyc2VNb2RlbCkge1xyXG4gICAgICAgIGN0cmwubW9kZWxzID0ge1xyXG4gICAgICAgICAgICBzZWxlY3RlZDogbnVsbCxcclxuICAgICAgICAgICAgc2VtZXN0ZXJzOiB7XHJcbiAgICAgICAgICAgICAgICAxOiBbXSxcclxuICAgICAgICAgICAgICAgIDI6IFtdLFxyXG4gICAgICAgICAgICAgICAgMzogW10sXHJcbiAgICAgICAgICAgICAgICA0OiBbXSxcclxuICAgICAgICAgICAgICAgIDU6IFtdLFxyXG4gICAgICAgICAgICAgICAgNjogW10sXHJcbiAgICAgICAgICAgICAgICA3OiBbXSxcclxuICAgICAgICAgICAgICAgIDg6IFtdXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHByZXJlcXM6IHt9LCAvLyB3aWxsIGJlIGtleSB2YWx1ZSBwYWlyIG9mIGNsYXNzIG5hbWUgYW5kIHByZXJlcXMgbGlzdCBcclxuICAgICAgICAgICAgbmFtZXM6IHt9LFxyXG4gICAgICAgICAgICBjcmVkaXRzOiB7fSxcclxuICAgICAgICAgICAgY3JlZGl0VG90YWw6IFswLCAwLCAwLCAwLCAwLCAwLCAwLCAwXSxcclxuICAgICAgICAgICAgY29uZmxpY3RpbmdDbGFzc2VzOiBbXVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgLy8gc2VtIDEgXHJcbiAgICAgICAgY29uc29sZS5sb2coXCJwb3B1bGF0aW5nIGxpc3RzXCIpXHJcbiAgICAgICAgdmFyIGNvdXJzZXMgPSAgQ291cnNlTW9kZWwuZ2V0Q291cnNlQnlTZW0oMSkudGhlbihmdW5jdGlvbihjb3Vyc2VzKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGlkeD0wOyBpZHg8Y291cnNlcy5sZW5ndGg7IGlkeCsrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgY2xhc3NOYW1lID0gY291cnNlc1tpZHhdLmF0dHJpYnV0ZXMuY291cnNlTmFtZTsgICAvLyBpZSBcIkNhbGN1bHVzIElJXCIgXHJcbiAgICAgICAgICAgICAgICBjdHJsLm1vZGVscy5zZW1lc3RlcnNbMV0ucHVzaChjbGFzc05hbWUpO1xyXG4gICAgICAgICAgICAgICAgY3RybC5tb2RlbHMucHJlcmVxc1tjbGFzc05hbWVdID0gY291cnNlc1tpZHhdLmF0dHJpYnV0ZXMucHJlcmVxdWlzaXRlczsgICAgIC8vIGllIFtcIk1BVEggMTA1NTBcIl1cclxuICAgICAgICAgICAgICAgIGN0cmwubW9kZWxzLm5hbWVzW2NsYXNzTmFtZV0gPSBjb3Vyc2VzW2lkeF0uYXR0cmlidXRlcy5jb3Vyc2VJZDsgICAgICAgICAgICAvLyBpZSBcIk1BVEggMTA1NjBcIlxyXG4gICAgICAgICAgICAgICAgY3RybC5tb2RlbHMuY3JlZGl0c1tjbGFzc05hbWVdID0gY291cnNlc1tpZHhdLmF0dHJpYnV0ZXMuY3JlZGl0czsgICAgICAgICAgIC8vIGllIDNcclxuICAgICAgICAgICAgICAgIGN0cmwubW9kZWxzLmNyZWRpdFRvdGFsWzBdICs9IGNvdXJzZXNbaWR4XS5hdHRyaWJ1dGVzLmNyZWRpdHM7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG5cclxuICAgICAgICAvLyBzZW0gMiBcclxuICAgICAgICBjb3Vyc2VzID0gIENvdXJzZU1vZGVsLmdldENvdXJzZUJ5U2VtKDIpLnRoZW4oZnVuY3Rpb24oY291cnNlcykge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpZHg9MDsgaWR4PGNvdXJzZXMubGVuZ3RoOyBpZHgrKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIGNsYXNzTmFtZSA9IGNvdXJzZXNbaWR4XS5hdHRyaWJ1dGVzLmNvdXJzZU5hbWU7ICAgLy8gaWUgXCJDYWxjdWx1cyBJSVwiIFxyXG4gICAgICAgICAgICAgICAgY3RybC5tb2RlbHMuc2VtZXN0ZXJzWzJdLnB1c2goY2xhc3NOYW1lKTtcclxuICAgICAgICAgICAgICAgIGN0cmwubW9kZWxzLnByZXJlcXNbY2xhc3NOYW1lXSA9IGNvdXJzZXNbaWR4XS5hdHRyaWJ1dGVzLnByZXJlcXVpc2l0ZXM7ICAgICAvLyBpZSBbXCJNQVRIIDEwNTUwXCJdXHJcbiAgICAgICAgICAgICAgICBjdHJsLm1vZGVscy5uYW1lc1tjbGFzc05hbWVdID0gY291cnNlc1tpZHhdLmF0dHJpYnV0ZXMuY291cnNlSWQ7ICAgICAgICAgICAgLy8gaWUgXCJNQVRIIDEwNTYwXCJcclxuICAgICAgICAgICAgICAgIGN0cmwubW9kZWxzLmNyZWRpdHNbY2xhc3NOYW1lXSA9IGNvdXJzZXNbaWR4XS5hdHRyaWJ1dGVzLmNyZWRpdHM7ICAgICAgICAgICAvLyBpZSAzXHJcbiAgICAgICAgICAgICAgICBjdHJsLm1vZGVscy5jcmVkaXRUb3RhbFsxXSArPSBjb3Vyc2VzW2lkeF0uYXR0cmlidXRlcy5jcmVkaXRzO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgLy8gc2VtIDMgXHJcbiAgICAgICAgY291cnNlcyA9ICBDb3Vyc2VNb2RlbC5nZXRDb3Vyc2VCeVNlbSgzKS50aGVuKGZ1bmN0aW9uKGNvdXJzZXMpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgaWR4PTA7IGlkeDxjb3Vyc2VzLmxlbmd0aDsgaWR4KyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBjbGFzc05hbWUgPSBjb3Vyc2VzW2lkeF0uYXR0cmlidXRlcy5jb3Vyc2VOYW1lOyAgIC8vIGllIFwiQ2FsY3VsdXMgSUlcIiBcclxuICAgICAgICAgICAgICAgIGN0cmwubW9kZWxzLnNlbWVzdGVyc1szXS5wdXNoKGNsYXNzTmFtZSk7XHJcbiAgICAgICAgICAgICAgICBjdHJsLm1vZGVscy5wcmVyZXFzW2NsYXNzTmFtZV0gPSBjb3Vyc2VzW2lkeF0uYXR0cmlidXRlcy5wcmVyZXF1aXNpdGVzOyAgICAgLy8gaWUgW1wiTUFUSCAxMDU1MFwiXVxyXG4gICAgICAgICAgICAgICAgY3RybC5tb2RlbHMubmFtZXNbY2xhc3NOYW1lXSA9IGNvdXJzZXNbaWR4XS5hdHRyaWJ1dGVzLmNvdXJzZUlkOyAgICAgICAgICAgIC8vIGllIFwiTUFUSCAxMDU2MFwiXHJcbiAgICAgICAgICAgICAgICBjdHJsLm1vZGVscy5jcmVkaXRzW2NsYXNzTmFtZV0gPSBjb3Vyc2VzW2lkeF0uYXR0cmlidXRlcy5jcmVkaXRzOyAgICAgICAgICAgLy8gaWUgM1xyXG4gICAgICAgICAgICAgICAgY3RybC5tb2RlbHMuY3JlZGl0VG90YWxbMl0gKz0gY291cnNlc1tpZHhdLmF0dHJpYnV0ZXMuY3JlZGl0cztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIC8vIHNlbSA0XHJcbiAgICAgICAgY291cnNlcyA9ICBDb3Vyc2VNb2RlbC5nZXRDb3Vyc2VCeVNlbSg0KS50aGVuKGZ1bmN0aW9uKGNvdXJzZXMpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgaWR4PTA7IGlkeDxjb3Vyc2VzLmxlbmd0aDsgaWR4KyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBjbGFzc05hbWUgPSBjb3Vyc2VzW2lkeF0uYXR0cmlidXRlcy5jb3Vyc2VOYW1lOyAgIC8vIGllIFwiQ2FsY3VsdXMgSUlcIiBcclxuICAgICAgICAgICAgICAgIGN0cmwubW9kZWxzLnNlbWVzdGVyc1s0XS5wdXNoKGNsYXNzTmFtZSk7XHJcbiAgICAgICAgICAgICAgICBjdHJsLm1vZGVscy5wcmVyZXFzW2NsYXNzTmFtZV0gPSBjb3Vyc2VzW2lkeF0uYXR0cmlidXRlcy5wcmVyZXF1aXNpdGVzOyAgICAgLy8gaWUgW1wiTUFUSCAxMDU1MFwiXVxyXG4gICAgICAgICAgICAgICAgY3RybC5tb2RlbHMubmFtZXNbY2xhc3NOYW1lXSA9IGNvdXJzZXNbaWR4XS5hdHRyaWJ1dGVzLmNvdXJzZUlkOyAgICAgICAgICAgIC8vIGllIFwiTUFUSCAxMDU2MFwiXHJcbiAgICAgICAgICAgICAgICBjdHJsLm1vZGVscy5jcmVkaXRzW2NsYXNzTmFtZV0gPSBjb3Vyc2VzW2lkeF0uYXR0cmlidXRlcy5jcmVkaXRzOyAgICAgICAgICAgLy8gaWUgM1xyXG4gICAgICAgICAgICAgICAgY3RybC5tb2RlbHMuY3JlZGl0VG90YWxbM10gKz0gY291cnNlc1tpZHhdLmF0dHJpYnV0ZXMuY3JlZGl0cztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIC8vIHNlbSA1XHJcbiAgICAgICAgY291cnNlcyA9ICBDb3Vyc2VNb2RlbC5nZXRDb3Vyc2VCeVNlbSg1KS50aGVuKGZ1bmN0aW9uKGNvdXJzZXMpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgaWR4PTA7IGlkeDxjb3Vyc2VzLmxlbmd0aDsgaWR4KyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBjbGFzc05hbWUgPSBjb3Vyc2VzW2lkeF0uYXR0cmlidXRlcy5jb3Vyc2VOYW1lOyAgIC8vIGllIFwiQ2FsY3VsdXMgSUlcIiBcclxuICAgICAgICAgICAgICAgIGN0cmwubW9kZWxzLnNlbWVzdGVyc1s1XS5wdXNoKGNsYXNzTmFtZSk7XHJcbiAgICAgICAgICAgICAgICBjdHJsLm1vZGVscy5wcmVyZXFzW2NsYXNzTmFtZV0gPSBjb3Vyc2VzW2lkeF0uYXR0cmlidXRlcy5wcmVyZXF1aXNpdGVzOyAgICAgLy8gaWUgW1wiTUFUSCAxMDU1MFwiXVxyXG4gICAgICAgICAgICAgICAgY3RybC5tb2RlbHMubmFtZXNbY2xhc3NOYW1lXSA9IGNvdXJzZXNbaWR4XS5hdHRyaWJ1dGVzLmNvdXJzZUlkOyAgICAgICAgICAgIC8vIGllIFwiTUFUSCAxMDU2MFwiXHJcbiAgICAgICAgICAgICAgICBjdHJsLm1vZGVscy5jcmVkaXRzW2NsYXNzTmFtZV0gPSBjb3Vyc2VzW2lkeF0uYXR0cmlidXRlcy5jcmVkaXRzOyAgICAgICAgICAgLy8gaWUgM1xyXG4gICAgICAgICAgICAgICAgY3RybC5tb2RlbHMuY3JlZGl0VG90YWxbNF0gKz0gY291cnNlc1tpZHhdLmF0dHJpYnV0ZXMuY3JlZGl0cztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIC8vIHNlbSA2XHJcbiAgICAgICAgY291cnNlcyA9ICBDb3Vyc2VNb2RlbC5nZXRDb3Vyc2VCeVNlbSg2KS50aGVuKGZ1bmN0aW9uKGNvdXJzZXMpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgaWR4PTA7IGlkeDxjb3Vyc2VzLmxlbmd0aDsgaWR4KyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBjbGFzc05hbWUgPSBjb3Vyc2VzW2lkeF0uYXR0cmlidXRlcy5jb3Vyc2VOYW1lOyAgIC8vIGllIFwiQ2FsY3VsdXMgSUlcIiBcclxuICAgICAgICAgICAgICAgIGN0cmwubW9kZWxzLnNlbWVzdGVyc1s2XS5wdXNoKGNsYXNzTmFtZSk7XHJcbiAgICAgICAgICAgICAgICBjdHJsLm1vZGVscy5wcmVyZXFzW2NsYXNzTmFtZV0gPSBjb3Vyc2VzW2lkeF0uYXR0cmlidXRlcy5wcmVyZXF1aXNpdGVzOyAgICAgLy8gaWUgW1wiTUFUSCAxMDU1MFwiXVxyXG4gICAgICAgICAgICAgICAgY3RybC5tb2RlbHMubmFtZXNbY2xhc3NOYW1lXSA9IGNvdXJzZXNbaWR4XS5hdHRyaWJ1dGVzLmNvdXJzZUlkOyAgICAgICAgICAgIC8vIGllIFwiTUFUSCAxMDU2MFwiXHJcbiAgICAgICAgICAgICAgICBjdHJsLm1vZGVscy5jcmVkaXRzW2NsYXNzTmFtZV0gPSBjb3Vyc2VzW2lkeF0uYXR0cmlidXRlcy5jcmVkaXRzOyAgICAgICAgICAgLy8gaWUgM1xyXG4gICAgICAgICAgICAgICAgY3RybC5tb2RlbHMuY3JlZGl0VG90YWxbNV0gKz0gY291cnNlc1tpZHhdLmF0dHJpYnV0ZXMuY3JlZGl0cztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIC8vIHNlbSA3XHJcbiAgICAgICAgY291cnNlcyA9ICBDb3Vyc2VNb2RlbC5nZXRDb3Vyc2VCeVNlbSg3KS50aGVuKGZ1bmN0aW9uKGNvdXJzZXMpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgaWR4PTA7IGlkeDxjb3Vyc2VzLmxlbmd0aDsgaWR4KyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBjbGFzc05hbWUgPSBjb3Vyc2VzW2lkeF0uYXR0cmlidXRlcy5jb3Vyc2VOYW1lOyAgIC8vIGllIFwiQ2FsY3VsdXMgSUlcIiBcclxuICAgICAgICAgICAgICAgIGN0cmwubW9kZWxzLnNlbWVzdGVyc1s3XS5wdXNoKGNsYXNzTmFtZSk7XHJcbiAgICAgICAgICAgICAgICBjdHJsLm1vZGVscy5wcmVyZXFzW2NsYXNzTmFtZV0gPSBjb3Vyc2VzW2lkeF0uYXR0cmlidXRlcy5wcmVyZXF1aXNpdGVzOyAgICAgLy8gaWUgW1wiTUFUSCAxMDU1MFwiXVxyXG4gICAgICAgICAgICAgICAgY3RybC5tb2RlbHMubmFtZXNbY2xhc3NOYW1lXSA9IGNvdXJzZXNbaWR4XS5hdHRyaWJ1dGVzLmNvdXJzZUlkOyAgICAgICAgICAgIC8vIGllIFwiTUFUSCAxMDU2MFwiXHJcbiAgICAgICAgICAgICAgICBjdHJsLm1vZGVscy5jcmVkaXRzW2NsYXNzTmFtZV0gPSBjb3Vyc2VzW2lkeF0uYXR0cmlidXRlcy5jcmVkaXRzOyAgICAgICAgICAgLy8gaWUgM1xyXG4gICAgICAgICAgICAgICAgY3RybC5tb2RlbHMuY3JlZGl0VG90YWxbNl0gKz0gY291cnNlc1tpZHhdLmF0dHJpYnV0ZXMuY3JlZGl0cztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIC8vIHNlbSA4XHJcbiAgICAgICAgY291cnNlcyA9ICBDb3Vyc2VNb2RlbC5nZXRDb3Vyc2VCeVNlbSg4KS50aGVuKGZ1bmN0aW9uKGNvdXJzZXMpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgaWR4PTA7IGlkeDxjb3Vyc2VzLmxlbmd0aDsgaWR4KyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBjbGFzc05hbWUgPSBjb3Vyc2VzW2lkeF0uYXR0cmlidXRlcy5jb3Vyc2VOYW1lOyAgIC8vIGllIFwiQ2FsY3VsdXMgSUlcIiBcclxuICAgICAgICAgICAgICAgIGN0cmwubW9kZWxzLnNlbWVzdGVyc1s4XS5wdXNoKGNsYXNzTmFtZSk7XHJcbiAgICAgICAgICAgICAgICBjdHJsLm1vZGVscy5wcmVyZXFzW2NsYXNzTmFtZV0gPSBjb3Vyc2VzW2lkeF0uYXR0cmlidXRlcy5wcmVyZXF1aXNpdGVzOyAgICAgLy8gaWUgW1wiTUFUSCAxMDU1MFwiXVxyXG4gICAgICAgICAgICAgICAgY3RybC5tb2RlbHMubmFtZXNbY2xhc3NOYW1lXSA9IGNvdXJzZXNbaWR4XS5hdHRyaWJ1dGVzLmNvdXJzZUlkOyAgICAgICAgICAgIC8vIGllIFwiTUFUSCAxMDU2MFwiXHJcbiAgICAgICAgICAgICAgICBjdHJsLm1vZGVscy5jcmVkaXRzW2NsYXNzTmFtZV0gPSBjb3Vyc2VzW2lkeF0uYXR0cmlidXRlcy5jcmVkaXRzOyAgICAgICAgICAgLy8gaWUgM1xyXG4gICAgICAgICAgICAgICAgY3RybC5tb2RlbHMuY3JlZGl0VG90YWxbN10gKz0gY291cnNlc1tpZHhdLmF0dHJpYnV0ZXMuY3JlZGl0cztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcblxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQG5nZG9jIGRpcmVjdGl2ZVxyXG4gICAgICogXHJcbiAgICAgKiBAZnVuY3Rpb24gY2FsY3VsYXRlQ3JlZGl0VG90YWxzUHJlcmVxc1xyXG4gICAgICogXHJcbiAgICAgKiBAZGVzY3JpcHRpb25cclxuICAgICAqIFRoaXMgZnVuY3Rpb24gaXMgdXNlZCB0byBjaGVjayBpZiB0aGVyZSBhcmUgdG9vIG1hbnkgY2xhc3NlcyBpbiBhIHNlbWVzdGVyIChnb2VzIG92ZXIgY3JlZGl0IG1heGltdW0pIGFuZCBhbGwgcHJlcmVxcyBhcmUgc2F0aXNmaWVkLlxyXG4gICAgICovXHJcblxyXG4gICAgZnVuY3Rpb24gY2FsY3VsYXRlQ3JlZGl0VG90YWxzUHJlcmVxcygpIHtcclxuICAgICAgICBhbmd1bGFyLmZvckVhY2goY3RybC5tb2RlbHMuc2VtZXN0ZXJzLCBmdW5jdGlvbiAodmFsdWUsIGtleSkge1xyXG4gICAgICAgICAgICBmb3IgKGxldCBpPTA7IGk8dmFsdWUubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGN0cmwubW9kZWxzLmNyZWRpdFRvdGFsW2tleS0xXSArPSBjdHJsLm1vZGVscy5jcmVkaXRzW2N0cmwubW9kZWxzLnNlbWVzdGVyc1trZXldW2ldXVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuXHJcblxyXG4gICAgICAgIC8vIENvbm5lY3RzIHNlbWVzdGVyIGxpc3RzIGZvciBkcmFwIGFuZCBkcm9wXHJcbiAgICAgICAgY3RybC5jbGFzc1dhcm5pbmcgPSBmYWxzZVxyXG5cclxuICAgICAgICBjdHJsLmNvdXJzZU1hcCA9IHtcclxuICAgICAgICAgICAgc3RvcDogZnVuY3Rpb24gKGUsIHVpKSB7XHJcbiAgICAgICAgICAgICAgICAvL3Jlc2V0IGNyZWRpdFRvdGFsc1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJjYWxjdWxhdGluZyBjcmVkaXRzXCIpXHJcbiAgICAgICAgICAgICAgICBjdHJsLm1vZGVscy5jcmVkaXRUb3RhbCA9IFswLCAwLCAwLCAwLCAwLCAwLCAwLCAwXVxyXG4gICAgICAgICAgICAgICAgY3RybC5jbGFzc1dhcm5pbmcgPSBmYWxzZVxyXG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcIlVwZGF0ZWQgQ291cnNlIE1hcFwiLCBKU09OLnN0cmluZ2lmeShjdHJsLm1vZGVscy5zZW1lc3RlcnMsIHVuZGVmaW5lZCwgMikpXHJcbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudENsYXNzZXMgPSBbXVxyXG4gICAgICAgICAgICAgICAgLy8gbG9vcCB0aHJvdWdoIHNlbWVzdGVyc1xyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCA5OyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICBsZW5ndGggPSBjdHJsLm1vZGVscy5zZW1lc3RlcnNbaV0ubGVuZ3RoXHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGxvb3AgdGhyb3VnaCBjbGFzc2VzXHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBsZW5ndGg7IGorKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBjYWxjdWxhdGUgbmV3IGNyZWRpdCB0b3RhbHNcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3RybC5tb2RlbHMuY3JlZGl0VG90YWxbaSAtIDFdICs9IGN0cmwubW9kZWxzLmNyZWRpdHNbY3RybC5tb2RlbHMuc2VtZXN0ZXJzW2ldW2pdXVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gbWFrZSBzdXJlIHRoYXQgbW92ZXMgZ2V0IHNhdmVkIHRvIHBhcnNlIC0gc2F2ZSBlYWNoIGNsYXNzK3NlbWVzdGVyXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIENvdXJzZU1vZGVsLmdldEJ5TmFtZShjdHJsLm1vZGVscy5zZW1lc3RlcnNbaV1bal0pLnRoZW4oZnVuY3Rpb24oY291cnNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImNvdXJzZSBiYWNrIGZyb20gZ2V0IGJ5IG5hbWU6IFwiLCBjb3Vyc2UpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBDb3Vyc2VNb2RlbC5zZXRTZW1lc3RlckRlZmF1bHQoY291cnNlLmlkLCBpKS50aGVuKGZ1bmN0aW9uKHN1Y2Nlc3MpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwic3VjY2VzcyFcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcHJlcmVxcyA9IGN0cmwubW9kZWxzLnByZXJlcXNbY3RybC5tb2RlbHMuc2VtZXN0ZXJzW2ldW2pdXVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocHJlcmVxcyAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGxlbmd0aCA9IHByZXJlcXMubGVuZ3RoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBsb29wIHRocm91Z2ggcHJlcmVxdWlzaXRlcyBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IG0gPSAwOyBtIDwgcGxlbmd0aDsgbSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRDbGFzc2VzLmluY2x1ZGVzKHByZXJlcXNbbV0pID09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiYnJlYWtpbmcgYSBwcmVyZXF1aXNpdGllcyBydWxlOiBcIikgLy8gaWYgcHJlcmVxIG5vdCBpbiBcInRha2VuXCIgY2xhc3Nlc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhwcmVyZXFzW21dKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdHJsLmNsYXNzV2FybmluZyA9IHRydWVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coY3RybC5jbGFzc1dhcm5pbmcpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAvLyBhcHBlbmQgb24gYWxsIGNsYXNzZXMgeW91J3ZlIHRha2VuIHNvIGZhciwgaW5jbHVkaW5nIHRoaXMgc2VtZXN0ZXJcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBrID0gMDsgayA8IGxlbmd0aDsgaysrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjbGFzc251bSA9IGN0cmwubW9kZWxzLm5hbWVzW2N0cmwubW9kZWxzLnNlbWVzdGVyc1tpXVtrXV1cclxuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudENsYXNzZXMucHVzaChjbGFzc251bSlcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJDcmVkaXRzOiBcIiwgY3RybC5tb2RlbHMuY3JlZGl0VG90YWwpXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHBsYWNlaG9sZGVyOiBcImNvdXJzZVwiLFxyXG4gICAgICAgICAgICBjb25uZWN0V2l0aDogXCIuY291cnNlLWxpc3RcIlxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwb3B1bGF0ZUxpc3RzKENvdXJzZU1vZGVsKTsgXHJcbiAgICBjYWxjdWxhdGVDcmVkaXRUb3RhbHNQcmVyZXFzKCk7IFxyXG4gICAgXHJcbiAgICBjdHJsLmFkZENsYXNzID0gZnVuY3Rpb24oZXZlbnQsIHNlbWVzdGVyKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ3NlbWVzdGVyOiAnLCBzZW1lc3RlcilcclxuICAgICAgICB2YXIgY29uZmlnID0ge1xyXG4gICAgICAgICAgICBwYXJlbnQ6IGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5ib2R5KSxcclxuICAgICAgICAgICAgY29udHJvbGxlcjogQWRkQ2xhc3NDb250cm9sbGVyLFxyXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICckY3RybCcsXHJcbiAgICAgICAgICAgIGRpc2FibGVQYXJlbnRTY3JvbGw6IHRydWUsIFxyXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy4vYWRkY2xhc3MuaHRtbCcsXHJcbiAgICAgICAgICAgIGhhc0JhY2tkcm9wOiB0cnVlLCBcclxuICAgICAgICAgICAgdHJhcEZvY3VzOiB0cnVlLCBcclxuICAgICAgICAgICAgY2xpY2tPdXRzaWRlVG9DbG9zZTogdHJ1ZSwgXHJcbiAgICAgICAgICAgIGVzY2FwZVRvQ2xvc2U6IHRydWUsIFxyXG4gICAgICAgICAgICBmb2N1c09uT3BlbjogdHJ1ZSxcclxuICAgICAgICAgICAgZnVsbHNjcmVlbjogdHJ1ZSwgXHJcbiAgICAgICAgICAgIHRhcmdldEV2ZW50OiBldmVudFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJG1kRGlhbG9nLnNob3coY29uZmlnKVxyXG4gICAgICAgICAgICAudGhlbihhbnN3ZXIgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2Fuc3dlcjogJywgYW5zd2VyKTsgXHJcbiAgICAgICAgICAgIH0pXHJcblxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQG5nZG9jIGRpcmVjdGl2ZVxyXG4gICAgICogXHJcbiAgICAgKiBAZnVuY3Rpb24gQWRkQ2xhc3NDb250cm9sbGVyXHJcbiAgICAgKiBcclxuICAgICAqIEBwYXJhbSB7Kn0gJHN0YXRlIFxyXG4gICAgICogQHBhcmFtIHsqfSAkbWREaWFsb2cgXHJcbiAgICAgKiBAcGFyYW0geyp9ICRodHRwIFxyXG4gICAgICogQHBhcmFtIHsqfSBKU09OU2VydmljZSBcclxuICAgICAqIEBwYXJhbSB7Kn0gQ291cnNlTW9kZWwgXHJcbiAgICAgKiBAcGFyYW0geyp9ICR3aW5kb3cgXHJcbiAgICAgKiBcclxuICAgICAqIEBkZXNjcmlwdGlvblxyXG4gICAgICogVGhpcyBmdW5jdGlvbiBhY3RzIGFzIHRoZSBhZGQgY2xhc3MgY29udHJvbGxlciAod2hpY2ggaXMgbm8gbG9uZXIgaXRzIG93biBwYWdlLCBidXQgYSBwb3B1cCkuIFdoZW4gdGhlIGFkZCBjbGFzcyBidXR0b24gaXMgY2xpY2tlZCxcclxuICAgICAqIGFsbCB0aGUgY2xhc3NlcyB0aGF0IGRvIG5vdCBoYXZlIGEgZGVmYXVsdCBzZW1lc3RlciBwb3B1bGF0ZSB0aGUgZGlhbG9ndWUgd2luZG93LiBXaGVuIGEgY2xhc3MgZ2V0cyBhZGRlZCwgb25jZSB0aGUgZGF0YSBpcyByZXR1cm5lZCBmcm9tIFxyXG4gICAgICogdGhlIGRiLCB0aGUgcG9wdXAgY2xvc2VzIGFuZCB0aGUgcGFnZSByZWZyZXNoZXMgdG8gcmVmbGVjdCB0aGUgdXBkYXRlZCBzZW1lc3RlciB2aWV3LlxyXG4gICAgICovXHJcblxyXG4gICAgZnVuY3Rpb24gQWRkQ2xhc3NDb250cm9sbGVyKCRzdGF0ZSwgJG1kRGlhbG9nLCAkaHR0cCwgSlNPTlNlcnZpY2UsIENvdXJzZU1vZGVsLCAkd2luZG93KSB7XHJcbiAgICAgICAgdmFyIGN0cmwgPSB0aGlzO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwicnVubmluZyBjb250cm9sbGVyXCIpXHJcbiAgICAgICAgY3RybC5hbGxDbGFzc2VzID0gW11cclxuICAgICAgICBDb3Vyc2VNb2RlbC5nZXRDb3Vyc2VzKCkudGhlbihmdW5jdGlvbihjb3Vyc2VzKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ2NvdXJzZXM6ICcsIGNvdXJzZXMpOyBcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvdXJzZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgaWYgKGNvdXJzZXNbaV0uYXR0cmlidXRlcy5zZW1lc3RlckRlZmF1bHQgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICBjdHJsLmFsbENsYXNzZXMucHVzaChjb3Vyc2VzW2ldKVxyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhjb3Vyc2VzW2ldLmF0dHJpYnV0ZXMuY291cnNlTmFtZSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zb2xlLmxvZygnY291cnNlcyBsaXN0ZWQuLi4nLCBjdHJsLmFsbENsYXNzZXMpXHJcbiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJjb3VsZG4ndCBmZXRjaCBjb3Vyc2VzXCIpXHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgY29uc29sZS5sb2coJ2NvdXJzZXMgbGlzdGVkLi4uJywgY3RybC5hbGxDbGFzc2VzKVxyXG5cclxuICAgICAgICAvLyBnbyB0aHJvdWdoIGVhY2ggb2YgdGhlIGNsYXNzZXMgdG8gZ2V0IHRoZSBkZXNjcmlwdGlvbiBvZiB0aGUgY2xhc3NcclxuICAgICAgICBjdHJsLmRvU2Vjb25kYXJ5QWN0aW9uID0gZnVuY3Rpb24oZXZlbnQsIGRlc2NyaXB0aW9uKSB7XHJcbiAgICAgICAgICAgICRtZERpYWxvZy5zaG93KFxyXG4gICAgICAgICAgICAgICAgJG1kRGlhbG9nLmFsZXJ0KClcclxuICAgICAgICAgICAgICAgIC50aXRsZShcIkNvdXJzZSBEZXNjcmlwdGlvblwiKVxyXG4gICAgICAgICAgICAgICAgLnRleHRDb250ZW50KGRlc2NyaXB0aW9uKVxyXG4gICAgICAgICAgICAgICAgLm9rKCdPaycpXHJcbiAgICAgICAgICAgICAgICAudGFyZ2V0RXZlbnQoZXZlbnQpXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgY3RybC5hZGRDb3Vyc2VUb1NlbWVzdGVyID0gZnVuY3Rpb24oZXZlbnQsIGNvdXJzZSkge1xyXG4gICAgICAgICAgICBDb3Vyc2VNb2RlbC5nZXRCeU5hbWUoY291cnNlKS50aGVuKGZ1bmN0aW9uKGNvdXJzZSkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3NlbmRpbmcgaWQgdG8gc2V0U2VtZXN0ZXJEZWZhdWx0JylcclxuICAgICAgICAgICAgICAgIENvdXJzZU1vZGVsLnNldFNlbWVzdGVyRGVmYXVsdChjb3Vyc2UuaWQsIHBhcnNlSW50KHNlbWVzdGVyKSkudGhlbihmdW5jdGlvbihzdWNjZXNzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3NldCBuZXcgZGVmYXVsdCcpXHJcbiAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcG9wdWxhdGVMaXN0cyhDb3Vyc2VNb2RlbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2ZhaWxlZCB0byBzZXQgbmV3IGRlZmF1bHQuJyk7IFxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgJG1kRGlhbG9nLmNhbmNlbCgpLnRoZW4oZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJzdWNjZXNzZnVsbHkgY2xvc2VkLlwiKVxyXG4gICAgICAgICAgICAgICAgICAgICRzdGF0ZS5yZWxvYWQoKTtcclxuICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImZhaWxlZCB0byBjbG9zZS5cIik7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG5cclxuICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygpXHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnZmFpbGVkIHRvIGdldCBjbGFzcycpXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG4gICAgIC8vIGRlbGV0ZSBjbGFzcyBcImNvbnRyb2xsZXJcIlxyXG4gICAgIGN0cmwuZGVsZXRlQ2xhc3MgPSBmdW5jdGlvbihldmVudCwgc2VtZXN0ZXIpIHtcclxuICAgICAgICBjb25zb2xlLmxvZygnc2VtZXN0ZXI6ICcsIHNlbWVzdGVyKVxyXG4gICAgICAgIHZhciBjb25maWcgPSB7XHJcbiAgICAgICAgICAgIHBhcmVudDogYW5ndWxhci5lbGVtZW50KGRvY3VtZW50LmJvZHkpLFxyXG4gICAgICAgICAgICBjb250cm9sbGVyOiBEZWxldGVDbGFzc0NvbnRyb2xsZXIsXHJcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJyRjdHJsJyxcclxuICAgICAgICAgICAgZGlzYWJsZVBhcmVudFNjcm9sbDogdHJ1ZSwgXHJcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnLi9kZWxldGVjbGFzcy5odG1sJyxcclxuICAgICAgICAgICAgaGFzQmFja2Ryb3A6IHRydWUsIFxyXG4gICAgICAgICAgICB0cmFwRm9jdXM6IHRydWUsIFxyXG4gICAgICAgICAgICBjbGlja091dHNpZGVUb0Nsb3NlOiB0cnVlLCBcclxuICAgICAgICAgICAgZXNjYXBlVG9DbG9zZTogdHJ1ZSwgXHJcbiAgICAgICAgICAgIGZvY3VzT25PcGVuOiB0cnVlLFxyXG4gICAgICAgICAgICBmdWxsc2NyZWVuOiB0cnVlLCBcclxuICAgICAgICAgICAgdGFyZ2V0RXZlbnQ6IGV2ZW50XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkbWREaWFsb2cuc2hvdyhjb25maWcpXHJcbiAgICAgICAgICAgIC50aGVuKGFuc3dlciA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnYW5zd2VyOiAnLCBhbnN3ZXIpOyBcclxuICAgICAgICAgICAgfSlcclxuXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBuZ2RvYyBkaXJlY3RpdmVcclxuICAgICAgICAgKiBcclxuICAgICAgICAgKiBAZnVuY3Rpb24gRGVsZXRlQ2xhc3NDb250cm9sbGVyXHJcbiAgICAgICAgICogXHJcbiAgICAgICAgICogQHBhcmFtIHsqfSAkc3RhdGUgXHJcbiAgICAgICAgICogQHBhcmFtIHsqfSAkbWREaWFsb2cgXHJcbiAgICAgICAgICogQHBhcmFtIHsqfSAkaHR0cCBcclxuICAgICAgICAgKiBAcGFyYW0geyp9IEpTT05TZXJ2aWNlIFxyXG4gICAgICAgICAqIEBwYXJhbSB7Kn0gQ291cnNlTW9kZWwgXHJcbiAgICAgICAgICogQHBhcmFtIHsqfSAkd2luZG93IFxyXG4gICAgICAgICAqIFxyXG4gICAgICAgICAqIEBkZXNjcmlwdGlvblxyXG4gICAgICAgICAqIFRoaXMgZnVuY3Rpb24gYWN0cyBhcyB0aGUgZGVsZXRlIGNsYXNzIGNvbnRyb2xsZXIsIHdoaWNoIG5vdyBnZW5lcmF0ZXMgZWFjaCBjbGFzcyBpbiBhIHNlbWVzdGVyIG9uIGEgcG9wdXAuIElmIHRoZSBkZWxldGUgYnV0dG9uIGlzIFxyXG4gICAgICAgICAqIGNsaWNrZWQsIHRoZSBzZW1lc3RlciBkZWZhdWx0IHZhbHVlIGlzIHNldCB0byBudWxsIGluIHRoZSBkYXRhYmFzZS4gT25jZSB0aGUgcHJvY2VzcyBmcm9tIHRoZSBkYiBpcyByZXR1cm5lZCB0aGUgcG9wdXAgY2xvc2VzIGFuZCBcclxuICAgICAgICAgKiB0aGUgcGFnZSByZWZyZXNoZXMgd2l0aCB0aGUgdXBkYXRlZCBzZW1lc3RlciBsaXN0LlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIFxyXG4gICAgICAgIGZ1bmN0aW9uIERlbGV0ZUNsYXNzQ29udHJvbGxlcigkc3RhdGUsICRtZERpYWxvZywgJGh0dHAsIEpTT05TZXJ2aWNlLCBDb3Vyc2VNb2RlbCwgJHdpbmRvdykge1xyXG4gICAgICAgICAgICB2YXIgY3RybCA9IHRoaXM7XHJcbiAgICAgICAgICAgIGN0cmwuYWxsQ2xhc3NlcyA9IFtdXHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwic2VtZXN0ZXIuLi4/IFwiLCBzZW1lc3RlcilcclxuICAgICAgICAgICAgQ291cnNlTW9kZWwuZ2V0Q291cnNlQnlTZW0ocGFyc2VJbnQoc2VtZXN0ZXIpKS50aGVuKGZ1bmN0aW9uKGNvdXJzZXMpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ2NvdXJzZXM6ICcsIGNvdXJzZXMpOyBcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb3Vyc2VzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBjdHJsLmFsbENsYXNzZXMucHVzaChjb3Vyc2VzW2ldKVxyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coY291cnNlc1tpXS5hdHRyaWJ1dGVzLmNvdXJzZU5hbWUpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ2NvdXJzZXMgbGlzdGVkLi4uJywgY3RybC5hbGxDbGFzc2VzKVxyXG4gICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJjb3VsZG4ndCBmZXRjaCBjb3Vyc2VzXCIpXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICBcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ2NvdXJzZXMgbGlzdGVkLi4uJywgY3RybC5hbGxDbGFzc2VzKVxyXG4gICAgICAgIFxyXG4gICAgICAgICAgICAvLyBnbyB0aHJvdWdoIGVhY2ggb2YgdGhlIGNsYXNzZXMgdG8gZ2V0IHRoZSBkZXNjcmlwdGlvbiBvZiB0aGUgY2xhc3NcclxuICAgICAgICAgICAgY3RybC5kb1NlY29uZGFyeUFjdGlvbiA9IGZ1bmN0aW9uKGV2ZW50LCBkZXNjcmlwdGlvbikge1xyXG4gICAgICAgICAgICAgICAgJG1kRGlhbG9nLnNob3coXHJcbiAgICAgICAgICAgICAgICAgICAgJG1kRGlhbG9nLmFsZXJ0KClcclxuICAgICAgICAgICAgICAgICAgICAudGl0bGUoXCJDb3Vyc2UgRGVzY3JpcHRpb25cIilcclxuICAgICAgICAgICAgICAgICAgICAudGV4dENvbnRlbnQoZGVzY3JpcHRpb24pXHJcbiAgICAgICAgICAgICAgICAgICAgLm9rKCdPaycpXHJcbiAgICAgICAgICAgICAgICAgICAgLnRhcmdldEV2ZW50KGV2ZW50KVxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICBcclxuICAgICAgICAgICAgY3RybC5yZW1vdmVDb3Vyc2VGcm9tU2VtZXN0ZXIgPSBmdW5jdGlvbihldmVudCwgY291cnNlKSB7XHJcbiAgICAgICAgICAgICAgICBDb3Vyc2VNb2RlbC5nZXRCeU5hbWUoY291cnNlKS50aGVuKGZ1bmN0aW9uKGNvdXJzZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdzZW5kaW5nIGlkIHRvIHNldFNlbWVzdGVyRGVmYXVsdCcpXHJcbiAgICAgICAgICAgICAgICAgICAgQ291cnNlTW9kZWwucmVtb3ZlU2VtZXN0ZXJEZWZhdWx0KGNvdXJzZS5pZCkudGhlbihmdW5jdGlvbihzdWNjZXNzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdzZXQgbmV3IGRlZmF1bHQnKVxyXG4gICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcG9wdWxhdGVMaXN0cyhDb3Vyc2VNb2RlbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdmYWlsZWQgdG8gc2V0IG5ldyBkZWZhdWx0LicpOyBcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICRtZERpYWxvZy5jYW5jZWwoKS50aGVuKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImNsb3NlZCBwb3B1cFwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHN0YXRlLnJlbG9hZCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJmYWlsZWQgdG8gY2xvc2VcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICBcclxuICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKClcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnZmFpbGVkIHRvIGdldCBjbGFzcycpXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSAgICBcclxuICAgIH1cclxufVxyXG5cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnY29tcG9uZW50cy5zZW1lc3RlcnMnKVxyXG4gICAgLmNvbnRyb2xsZXIoJ1NlbWVzdGVyc0NvbnRyb2xsZXInLCBTZW1lc3RlcnNDb250cm9sbGVyKTsiLCJhbmd1bGFyLm1vZHVsZSgndGVtcGxhdGVzJywgW10pLnJ1bihbJyR0ZW1wbGF0ZUNhY2hlJywgZnVuY3Rpb24oJHRlbXBsYXRlQ2FjaGUpIHskdGVtcGxhdGVDYWNoZS5wdXQoJy4vcm9vdC5odG1sJywnPGRpdiBjbGFzcz1cInJvb3RcIj5cXHJcXG4gICAgPGRpdiB1aS12aWV3PjwvZGl2PlxcclxcbjwvZGl2PicpO1xuJHRlbXBsYXRlQ2FjaGUucHV0KCcuL2FwcC1uYXYuaHRtbCcsJzxoZWFkZXI+XFxyXFxuICA8bWQtdG9vbGJhcj5cXHJcXG4gICAgICA8ZGl2IGNsYXNzPVwibWQtdG9vbGJhci10b29sc1wiIGxheW91dD1cInJvd1wiIGxheW91dC1hbGlnbj1cInNwYWNlLWJldHdlZW4gY2VudGVyXCI+XFxyXFxuICAgICAgICAgIDxkaXY+XFxyXFxuICAgICAgICAgICAgICA8YSBocmVmPVwiI1wiPjxpIGNsYXNzPVwibWF0ZXJpYWwtaWNvbnNcIj5ob21lPC9pPjwvYT5cXHJcXG4gICAgICAgICAgPC9kaXY+XFxyXFxuICAgICAgICAgIDxkaXY+XFxyXFxuICAgICAgICAgICAgICA8aDM+Q291cnNlIFBsYW5uZXI8L2gzPlxcclxcbiAgICAgICAgICA8L2Rpdj5cXHJcXG4gICAgICA8L2Rpdj5cXHJcXG4gIDwvbWQtdG9vbGJhcj5cXHJcXG48L2hlYWRlcj4nKTtcbiR0ZW1wbGF0ZUNhY2hlLnB1dCgnLi9hcHAuaHRtbCcsJzxkaXYgY2xhc3M9XCJyb290XCI+XFxyXFxuICA8ZGl2PlxcclxcbiAgICA8ZGl2IHVpLXZpZXc+PC9kaXY+XFxyXFxuICA8L2Rpdj5cXHJcXG48L2Rpdj4nKTtcbiR0ZW1wbGF0ZUNhY2hlLnB1dCgnLi9ob21lLmh0bWwnLCc8YXBwLW5hdj48L2FwcC1uYXY+XFxyXFxuPG1kLWlucHV0LWNvbnRhaW5lciBjbGFzcz1cIm1kLWJsb2NrXCIgZmxleC1ndC1zbT5cXHJcXG4gICAgPGgyPkNob29zZSB5b3VyIG1ham9yIHRvIGdldCBzdGFydGVkLjwvaDI+XFxyXFxuICAgIDxsYWJlbD5NeSBNYWpvcjwvbGFiZWw+XFxyXFxuICAgIDxtZC1zZWxlY3QgbmctbW9kZWw9XCJtYWpvckNob3NlblwiIG5nLWNoYW5nZT1cIm9uQ2hhbmdlKClcIj5cXHJcXG4gICAgICA8IS0tIHN0YXRlZnVsIGNvbXBvbmVudCAtLT5cXHJcXG4gICAgICA8bWQtb3B0aW9uIG5nLXJlcGVhdD1cIm1ham9yIGluICRjdHJsLm1ham9yc1wiIHZhbHVlPVwie3ttYWpvcn19XCI+XFxyXFxuICAgICAgICB7e21ham9yfX1cXHJcXG4gICAgICA8L21kLW9wdGlvbj5cXHJcXG4gICAgPC9tZC1zZWxlY3Q+XFxyXFxuICA8L21kLWlucHV0LWNvbnRhaW5lcj5cXHJcXG5cXHJcXG4gIDxtZC1idXR0b24gbWQtbm8taW5rIGNsYXNzPVwibWQtZ28tYnV0dG9uXCIgbmctY2xpY2sgPSBcInNhdmVNYWpvcigpXCIgaHJlZj1cIiMvc2VtZXN0ZXJzXCI+R288L21kLWJ1dHRvbj4nKTtcbiR0ZW1wbGF0ZUNhY2hlLnB1dCgnLi9hZGRjbGFzcy5odG1sJywnPCEtLSBzdGF0ZWZ1bCBjb21wb25lbnQgLS0+XFxyXFxuICA8bWQtaW5wdXQtY29udGFpbmVyIGNsYXNzPVwibWQtYmxvY2stYWRkY2xhc3NcIiBmbGV4LWd0LXNtPlxcclxcbiAgICAgIDxoMSBjbGFzcz1cImFkZGl0aW9uYWwtb3B0aW9uc1wiPkFkZGl0aW9uYWwgQ2xhc3MgT3B0aW9uczwvaDE+IFxcclxcbiAgICA8IS0tIHN0YXRlbGVzcyBjb21wb25lbnQgLS0+XFxyXFxuICAgIDxtZC1saXN0LWl0ZW0gbmctcmVwZWF0PVwiY291cnNlIGluICRjdHJsLmFsbENsYXNzZXNcIiB2YWx1ZT1cInt7Y291cnNlLmF0dHJpYnV0ZXMuY291cnNlTmFtZX19XCIgY2xhc3M9XCJzZWNvbmRhcnktYnV0dG9uLXBhZGRpbmctY2xhc3MgYWRkQ2xhc3MtaXRlbXNcIj5cXHJcXG4gICAgICA8cD57e2NvdXJzZS5hdHRyaWJ1dGVzLmNvdXJzZU5hbWV9fTwvcD5cXHJcXG4gICAgICA8bWQtYnV0dG9uIGNsYXNzPVwibWQtc2Vjb25kYXJ5XCIgbmctY2xpY2s9XCIkY3RybC5hZGRDb3Vyc2VUb1NlbWVzdGVyKCRldmVudCwgY291cnNlLmF0dHJpYnV0ZXMuY291cnNlTmFtZSlcIiBocmVmPVwiIy9zZW1lc3RlcnNcIj5hZGQgY2xhc3M8L21kLWJ1dHRvbj5cXHJcXG4gICAgPC9tZC1saXN0LWl0ZW0+XFxyXFxuICA8L21kLWlucHV0LWNvbnRhaW5lcj5cXHJcXG4nKTtcbiR0ZW1wbGF0ZUNhY2hlLnB1dCgnLi9kZWxldGVjbGFzcy5odG1sJywnPCEtLSBzdGF0ZWZ1bCBjb21wb25lbnQgLS0+XFxyXFxuPG1kLWlucHV0LWNvbnRhaW5lciBjbGFzcz1cIm1kLWJsb2NrLWFkZGNsYXNzXCIgZmxleC1ndC1zbT5cXHJcXG4gICAgPGgxIGNsYXNzPVwiYWRkaXRpb25hbC1vcHRpb25zXCI+UmVtb3ZlIENsYXNzPC9oMT4gXFxyXFxuICA8IS0tIHN0YXRlbGVzcyBjb21wb25lbnQgLS0+XFxyXFxuICA8bWQtbGlzdC1pdGVtIG5nLXJlcGVhdD1cImNvdXJzZSBpbiAkY3RybC5hbGxDbGFzc2VzXCIgdmFsdWU9XCJ7e2NvdXJzZS5hdHRyaWJ1dGVzLmNvdXJzZU5hbWV9fVwiIGNsYXNzPVwic2Vjb25kYXJ5LWJ1dHRvbi1wYWRkaW5nLWNsYXNzXCI+XFxyXFxuICAgIDxwPnt7Y291cnNlLmF0dHJpYnV0ZXMuY291cnNlTmFtZX19PC9wPlxcclxcbiAgICA8bWQtYnV0dG9uIGNsYXNzPVwibWQtc2Vjb25kYXJ5XCIgbmctY2xpY2s9XCIkY3RybC5yZW1vdmVDb3Vyc2VGcm9tU2VtZXN0ZXIoJGV2ZW50LCBjb3Vyc2UuYXR0cmlidXRlcy5jb3Vyc2VOYW1lKVwiIGhyZWY9XCIjL3NlbWVzdGVyc1wiPnJlbW92ZSBjbGFzczwvbWQtYnV0dG9uPlxcclxcbiAgPC9tZC1saXN0LWl0ZW0+XFxyXFxuPC9tZC1pbnB1dC1jb250YWluZXI+XFxyXFxuJyk7XG4kdGVtcGxhdGVDYWNoZS5wdXQoJy4vc2VtZXN0ZXJzLmh0bWwnLCc8YXBwLW5hdj48L2FwcC1uYXY+XFxyXFxuPGRpdiBjbGFzcz1cImNvdXJzZS1tYXBcIj5cXHJcXG4gICAgPG1kLWNvbnRlbnQgbGF5b3V0LXBhZGRpbmc+XFxyXFxuICAgICAgICA8ZGl2IG5nLXNob3c9XCIkY3RybC5jbGFzc1dhcm5pbmdcIiBjbGFzcz1cIndhcm5pbmctdGV4dFwiPlxcclxcbiAgICAgICAgICAgIE9uZSBvciBtb3JlIGNsYXNzZXMgbmVlZCBhZGp1c3RpbmcgdG8gc2F0aXNmeSBwcmVyZXF1aXNpdGUgcmVxdWlyZW1lbnRzLiBcXHJcXG4gICAgICAgIDwvZGl2PlxcclxcbiAgICAgICAgPCEtLSBHcmlkIExpc3QgdG8gS2VlcCBldmVuIGxheW91dCAtLT5cXHJcXG4gICAgICAgIDxtZC1ncmlkLWxpc3QgIG1kLWNvbHMtc209XCIxXCIgbWQtY29scy1tZD1cIjFcIiBtZC1jb2xzLWxnPVwiMlwiIG1kLWNvbHMtZ3QtbGc9XCIzXCIgbWQtY29scz0xIG1kLXJvdy1oZWlnaHQtbWQ9XCIxOjFcIiBtZC1yb3ctaGVpZ2h0PVwiMS4yOjFcIlxcclxcbiAgICAgICAgICAgIG1kLWd1dHRlci1ndC1tZD1cIjE2cHhcIiBtZC1ndXR0ZXItbWQ9XCI4cHhcIiBtZC1ndXR0ZXI9XCI0cHhcIj5cXHJcXG4gICAgICAgICAgICA8IS0tIEVhY2ggVGlsZSBob2xkcyBhIGxpc3Qgb2Ygc2VtZXN0ZXIgY291cnNlcyAtLT5cXHJcXG4gICAgICAgICAgICA8IS0tIHN0YXRlZnVsIGNvbXBvbmVudCAtLT5cXHJcXG4gICAgICAgICAgICA8bWQtZ3JpZC10aWxlIG5nLXJlcGVhdD1cIihrZXksIHNlbWVzdGVyKSBpbiAkY3RybC5tb2RlbHMuc2VtZXN0ZXJzXCI+XFxyXFxuICAgICAgICAgICAgICAgIDwhLS0gdWktc29ydGFibGUgYWxsb3dzIGRyYWcgZHJvcCBzb3J0aW5nIG9mIFxcclxcbiAgICAgICAgICAgICAgICAgICAgYXJyYXlzIGNvdXJzZU1hcCBpcyB0aGUgZHJhZyBkcm9wIGdyb3VwIC0tPlxcclxcbiAgICAgICAgICAgICAgICAgICAgPCEtLSBzdGF0ZWxlc3MgY29tcG9uZW50IC0tPlxcclxcbiAgICAgICAgICAgICAgICA8bWQtbGlzdCB1aS1zb3J0YWJsZT1cIiRjdHJsLmNvdXJzZU1hcFwiIGNsYXNzPVwiY291cnNlLWxpc3RcIiBuZy1tb2RlbD1cInNlbWVzdGVyXCI+XFxyXFxuICAgICAgICAgICAgICAgICAgICA8bWQtc3ViaGVhZGVyIGNsYXNzPVwibWQtbm8tc3RpY2t5XCI+U2VtZXN0ZXIge3skaW5kZXgrMX19PC9tZC1zdWJoZWFkZXI+XFxyXFxuICAgICAgICAgICAgICAgICAgICA8IS0tIHJlcGVhdHMgZWFjaCBjbGFzcyBpbiBhIHNlbWVzdGVyIC0tPlxcclxcbiAgICAgICAgICAgICAgICAgICAgPG1kLWxpc3QtaXRlbSBuZy1yZXBlYXQ9XCJpdGVtIGluIHNlbWVzdGVyXCIgY2xhc3M9XCJtZC0yLWxpbmUgY291cnNlXCI+XFxyXFxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm1kLWxpc3QtaXRlbS10ZXh0XCI+XFxyXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt7aXRlbX19XFxyXFxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XFxyXFxuICAgICAgICAgICAgICAgICAgICAgICAgPG1kLWRpdmlkZXI+PC9tZC1kaXZpZGVyPlxcclxcbiAgICAgICAgICAgICAgICAgICAgPC9tZC1saXN0LWl0ZW0+XFxyXFxuICAgICAgICAgICAgICAgICAgICA8IS0tIGRpc3BsYXkgdGhlIHJ1bm5pbmcgdG90YWwgb2YgY3JlZGl0cyBmb3IgZWFjaCBzZW1lc3Rlci0tPlxcclxcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBzdHlsZT1cIm1hcmdpbjogMzBweFwiPjwvZGl2PlxcclxcbiAgICAgICAgICAgICAgICAgICAgPHA+Q3JlZGl0czoge3skY3RybC5tb2RlbHMuY3JlZGl0VG90YWxbJGluZGV4XX19XFxyXFxuICAgICAgICAgICAgICAgICAgICA8bWQtYnV0dG9uIHN0eWxlPVwiZmxvYXQ6IHJpZ2h0OyBtYXJnaW4tdG9wOiAtMTBweFwiIG5nLWNsaWNrID0gXCIkY3RybC5kZWxldGVDbGFzcygkZXZlbnQsIGtleSlcIj5EZWxldGUgQ2xhc3M8L21kLWJ1dHRvbj5cXHJcXG4gICAgICAgICAgICAgICAgICAgIDxtZC1idXR0b24gc3R5bGU9XCJmbG9hdDogcmlnaHQ7IG1hcmdpbi10b3A6IC0xMHB4XCIgbmctY2xpY2sgPSBcIiRjdHJsLmFkZENsYXNzKCRldmVudCwga2V5KVwiPkFkZCBDbGFzczwvbWQtYnV0dG9uPjwvcD5cXHJcXG4gICAgICAgICAgICAgICAgPC9tZC1saXN0PlxcclxcbiAgICAgICAgICAgIDwvbWQtZ3JpZC10aWxlPlxcclxcbiAgICAgICAgPC9tZC1ncmlkLWxpc3Q+XFxyXFxuICAgIDwvbWQtY29udGVudD5cXHJcXG48L2Rpdj4nKTt9XSk7Il19
